#include <iostream>
#include <functional>
#include <sstream>
#include <ncurses.h>
//#include <unistd.h>
#include "DungeonLevel.h"
#include "GenericFactory.h"
#include "Tile.h"
#include "Entity.h"
#include "Player.h"

using namespace std;
/*
int millisleep(unsigned ms)
{
	
	return usleep(1000 * ms);
}
*/

void placeBomb(DungeonLevel & dung)
{
	int x = 7 + (dung.randomNumber(dung.getVector().size() - 8));
	int y = dung.randomNumber(dung.getVector()[x].size());
	while(dung.getVector()[x][y].getTraversable() == false)
	{
		x = 7 + (dung.randomNumber(dung.getVector().size() - 8));
		y = dung.randomNumber(dung.getVector()[x].size());
	}
	dung.getVector()[x][y].set_holdsBomb(true);
	dung.getVector()[x][y].set_bombCounter(3);
	for (int i = (x - 2); i < (x + 3); i++)
	{
		for (int j = (y - 2); j < (y + 3); j++)
		{
			dung.getVector()[i][j].set_holdsBombRadius(true);
		}
	}
}


void specialLevel(DungeonLevel & dung)
{
	stringstream vSpecial;
	vSpecial << "0000000000000000000000000000000000000000000000000000000000000000000000000000000";
	vSpecial << "0000000000000000000000000000000000000000000000000000000000000000000000000000000";
	vSpecial << "0000000000555555555555555555555555555555555555555555555555555555555555500000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111113800000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111155800000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000000000000000000000000000000000000000000000000000000000000000000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000611111111111111111111111111111111111111111111111111111111180000000000";
	vSpecial << "0000000000677777777777777777777777777648777777777777777777777777777780000000000";
	vSpecial << "0000000000000000000000000000000000000678000000000000000000000000000000000000000";
	vSpecial << "0000000000000000000000000000000000000000000000000000000000000000000000000000000";

	char h;
	for (int i = 0; i < 20; i++)
	{
		for (int j = 0; j < 79; j++)
		{
			//cout << "trying static cast: " << static_cast<int>(vSpecial[i][j]) << " " << vSpecial[i][j];
			//h = vSpecial[i][j];
			//cout << " " << static_cast<int>(h) << endl;
			vSpecial.get(h);
			dung.getVector()[i][j].useTemplate(static_cast<unsigned int>(h) - 48);
			dung.getVector()[i][j].revealHidden();
			//cout << dung.getVector()[i][j].getDisplaySymbol();
			//cout << static_cast<unsigned int>(h) - 48;
		}
		//cout << endl;
	}
}
void displaydisplayVector( vector<vector<char>> displayVector)
{
	//for Windows
	for (int i = 0; i < displayVector.size(); i++)
	{
		for (int j = 0; j < displayVector[i].size(); j++)
		{
			cout << displayVector[i][j];
		}
		//cout << endl;
	}
}
//Un-comment for ncurses

void updateNcurses(vector<vector<char>> displayVector)
{
	clear();
	for (size_t i = 0; i < displayVector.size(); i++)
	{
		for (size_t j = 0; j < displayVector[i].size(); j++)
		{
			move(i,j);
			addch(displayVector[i][j]);
		}
	}
	refresh();
}



void updateDisplay(stringstream & display, vector<vector<char>> & displayVector)
{
	for (int i = 0; i < displayVector.size(); i++)
	{
		for (int j = 0; j < displayVector[i].size(); j++)
		{
			displayVector[i][j] = ' ';
		}
	}

	vector<string> midVec;
	string line;

	char ch;
	int i = 0;
	int j = 0;
	while(i < 40)
	{
		display.get(ch);
		if ((ch == '\n')||(j == 79))
		{
			i++;
			j = 0;
			//display << endl;
		}
		else 
		{
			displayVector[i][j] = ch;
			//display << ch;
			j++;
		}
	}
	display.str("");
	display.clear();
}
void storyBoards(stringstream & display, vector<vector<char>> & displayVector, string & myName, string & gfName, int & progress)
{
	if (progress == 0)
	{
		display << noskipws;
		display << "                                                                              " << endl;
		display << " ____________________________________________________________________________ " << endl;
		display << "//%%%%%%../%%%%../%%./%%../%%%%../%%./%%........../%%%%../%%./%%./%%./%%.....|" << endl;    
		display << "/. /%%.../%%./%%./%%./%%./%%==.../%%./%%........./%%==.../%%./%%../%%%%......|" << endl;     
		display << "/../%%.../%%./%%./%%./%%./%%/%%%./%%%%%%./%%%%%%./%%/%%%./%%./%%.../%%.......|" << endl;    
		display << "/../%%.../%%./%%./%%./%%./%%./%%./%%./%%.======../%%./%%./%%./%%.../%%.......|" << endl;    
		display << "/../%%..../%%%%'../%%%%'../%%%%'./%%./%%........../%%%%'../%%%%..../%%.......|" << endl;     
		display << "/..==.....====....====....====...==..==...........====....====.....==........|" << endl;     
		display << "/.../%%../%%../%%%%../%%%%%../%%%%%%./%%./%%../%%%%../%%./%%../%%%%../%%%%%%.|" << endl;     
		display << "/.../%%../%%./%%./%%./%%./%%./%%===../%%./%%./%%./%%./%%./%%./%%==.../%%===..|" << endl;     
		display << "/.../%%/%/%%./%%%%%%./%%%%%'./%%%%.../%%%%%%./%%./%%./%%./%%../%%%%../%%%%...|" << endl;
		display << "/.../%%%%%%%./%%./%%./%%./%%./%%=..../%%./%%./%%./%%./%%./%%...../%%./%%=....|" << endl;
		display << "/..../%%'%%'./%%./%%./%%./%%./%%%%%%./%%./%%../%%%%'../%%%%'../%%%%'./%%%%%%.|" << endl;
		display << "/....==.==...==..==..==..==..======..==..==...====....====....====...======..|" << endl;
		display << "/............................................................................|" << endl;
		display << "/%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%|" << endl;
		display << "============================================================================' " << endl;
		display << "                                                                              " << endl;
		display << "                Type Your Name and Hit 'Enter' to Start                       " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << " Enter your Name (max 8 characters):                                          " << endl;
		updateDisplay(display, displayVector);
		progress++;
	}
	else if (progress == 1)
	{
		display << noskipws;
		display << "                                                                              " << endl;
		display << " ____________________________________________________________________________ " << endl;
		display << "//%%%%%%../%%%%../%%./%%../%%%%../%%./%%........../%%%%../%%./%%./%%./%%.....|" << endl;    
		display << "/. /%%.../%%./%%./%%./%%./%%==.../%%./%%........./%%==.../%%./%%../%%%%......|" << endl;     
		display << "/../%%.../%%./%%./%%./%%./%%/%%%./%%%%%%./%%%%%%./%%/%%%./%%./%%.../%%.......|" << endl;    
		display << "/../%%.../%%./%%./%%./%%./%%./%%./%%./%%.======../%%./%%./%%./%%.../%%.......|" << endl;    
		display << "/../%%..../%%%%'../%%%%'../%%%%'./%%./%%........../%%%%'../%%%%..../%%.......|" << endl;     
		display << "/..==.....====....====....====...==..==...........====....====.....==........|" << endl;     
		display << "/.../%%../%%../%%%%../%%%%%../%%%%%%./%%./%%../%%%%../%%./%%../%%%%../%%%%%%.|" << endl;     
		display << "/.../%%../%%./%%./%%./%%./%%./%%===../%%./%%./%%./%%./%%./%%./%%==.../%%===..|" << endl;     
		display << "/.../%%/%/%%./%%%%%%./%%%%%'./%%%%.../%%%%%%./%%./%%./%%./%%../%%%%../%%%%...|" << endl;
		display << "/.../%%%%%%%./%%./%%./%%./%%./%%=..../%%./%%./%%./%%./%%./%%...../%%./%%=....|" << endl;
		display << "/..../%%'%%'./%%./%%./%%./%%./%%%%%%./%%./%%../%%%%'../%%%%'../%%%%'./%%%%%%.|" << endl;
		display << "/....==.==...==..==..==..==..======..==..==...====....====....====...======..|" << endl;
		display << "/............................................................................|" << endl;
		display << "/%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%|" << endl;
		display << "============================================================================' " << endl;
		display << "                                                                              " << endl;
		display << "		        Choose a name for your girlfriend:                            " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << "                                                                              " << endl;
		display << " Enter your Girlfriend's Name (max 8 characters):                             " << endl;
		updateDisplay(display, displayVector);
		progress++;
	}
	else if (progress == 2)
	{
		display << std::noskipws;
		display << "                                                                            " << endl;
		display << "      You come home one night to find                                       " << endl;
		display << "                                                                            " << endl;
		display << "                                       an empty apartment...                " << endl;
		display << "                                                                            " << endl;
		display << "                 Weird...                                                   " << endl;
		display << "                                                                            " << endl;
		display << "                                           She's normally home at this time." << endl;
		display << "                                                                            " << endl;
		display << "                                                                            " << endl;
		display << " You're just about to give her a call when...                               " << endl;
		display << "                                                                            " << endl;
		display << "                                                                            " << endl;
		display << "                                                 77777777                   " << endl;
		display << "                                     77??+++===================+++?7        " << endl;
		display << "                                 ?++===~:,,,,~,,,,,,,,,,,,,,,,,,,,,:~=++?   " << endl;
		display << "     \"RIIINNG!!!\"              =~+?+~,,,,,,,~~,,,,,,,,,,,,,:::,,,,,,=??:::7 " << endl;
		display << "                            ~+~,::~::::,,,=+:::==========:~:,:7.,,::=~::,,, " << endl;
		display << "         \"RIINNNGG!!!\"    :   ,,,:::::::,.7:::::::::::::::~:,:7.,,:,::,,,,,7" << endl;
		display << "                         ~.7= ,,,,,::,,=,,:~~~::::::::::::::::::,,,,,,,,,,,I" << endl;
		display << "                          :~,7:,,,,=,,,+:~==+++==++==~=========~~,+~,,,,,:~I" << endl;
		display << "                          :~, ,~::::,,,+:++++=++II==I7I+?7I=======+~,,,:::=7" << endl;
		display << "                         7,:,7 ,~:,:? ?+:+++++++,,,+,,,+:,,+=+====:+,::::~7 " << endl;
		display << "                          +:,?        7+,+++++++I7I=~7I=+77=+++===~+777   7 " << endl;
		display << "                         ?::77        7+,++++++=,,,=~,,+=,,?+++=====:       " << endl;
		display << "                        I::7   ~,~    7+:++++++=+77=?I7+:7I+=++====:=       " << endl;
		display << "                 7  7 :,:.:7  7~7,7  7~+:+++++++:,,++,:?+:::=======:+       " << endl;
		display << "   7~~::::::::::::::~:::~     :+:,:777=+:++++++=~I7~,77+=?II========+:      " << endl;
		display << " 7=~::,::::::,::::,:::~7I77  :+~, 777?~+:+++++=+=,,=~,,,+,,,==========7     " << endl;
		display << "7~=:,7                     7=:::  777I~+:++++++=7 7        7========:+I777  " << endl;
		display << "I:~+=7                   7~:,:=  7777I~+:++++++=777777777III?=======:+I7    " << endl;
		display << "7+~,,::=++==777 777 7=~++~,:~   777 7I::=+???+++++++++++++++++++++=~:,:     " << endl;
		display << "  7?:~~~~::,,~~~::~::.:::,= 77777    7:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,     " << endl;
		display << "        7?=:,:~~:::::====+?7         7,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,7    " << endl;
		display << "                    7                +,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,7    " << endl;
		display << "                                     =:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,I    " << endl;
		display << "                                     ~:,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,:I    " << endl;
		display << "                                     ~:::::::::::::::::::::::::::::::::7    " << endl;
		display << "                                     I~....:::::::::::::::,,:::::.....=7    " << endl;
		display << "                                       7 7             7    77 7 777 7      " << endl;
		updateDisplay(display, displayVector);
		progress++;
	}
	else if (progress == 3)
	{
	
		display << noskipws; 	
		display << "                                                                            " << endl;
		display << "                      ............                                          " << endl;
		display << "                     ..,::,,........                                        " << endl;
		display << "                    .,:~=+=~:,,......                                       " << endl;
		display << "                   ..~=++++?+~:,......                                      " << endl;
		display << "                  =.:~+++?????=:~:,:,.                                      " << endl;
		display << "                 =.,~+++?????I???++=:,                                      " << endl;
		display << "                 =:===++???III???++=~.                                      " << endl;
		display << "                 +=++=:+?IIII???+++~,                                       " << endl;
		display << "                 :=?=?~:~??I???+++=,          \"HELLO?\"                      " << endl;
		display << "                 ~+???++++?++++++=~.                                        " << endl;
		display << "                 =+????++I=+?,,~,=:                        \"???\"          " << endl;
		display << "                 =+???++??+??+=++:==+                                       " << endl;
		display << "                ~++??????++????+~?I==~                                      " << endl;
		display << "                =++??????++??+=:=====~                                      " << endl;
		display << "            ,,=++=++=+??????+=,:~=II?+                                      " << endl;
		display << "    ,,??II+++++?+++?+++?+=+=~,,~?I??I+                                      " << endl;
		display << " ~??IIIII7?+++????=+????++=~~,++??+?++                                      " << endl;
		display << "IIIIIIIIIII+???????=+++==~~~=??+++??++~    \"psst.. hey, Tough-Guy...\"       " << endl;
		display << "IIIII77I777?++?????++========+==?II?+?          \"you think you're some kinda" << endl;
		display << "777777777777????????==??=======~+???++               badass, huh? \"         " << endl;
		display << "7777777777777???????==========+++?I?=+?=:                                   " << endl;
		display << "777777777777777???+==+,===+?++++???+~+???                                   " << endl;
		display << "77777777777777777?++,IIIIIII??+????+??III?          \"well guess what...\"    " << endl;
		display << "77777777777777777I,:77IIIIIII?+????+IIIIII                                  " << endl;
		display << "77777777777777777,~7I7777777II??III+IIIIII                                  " << endl;
		display << "77777777777777777:I7777777777I??I???+IIIII                                  " << endl;
		display << "7777777777777777=,77777777777I??????=IIIII                                  " << endl;
		display << "7777777777777777=77I777777777I??????=IIIII                                  " << endl;
		display << "77777777777777I+,7II777777777I??????=?IIII                                  " << endl;
		display << "777777777777777?:77I777777777I??????+~?II?                                  " << endl;
		display << "777777777777777,7777777777777I+????+?=+II?                                  " << endl;
		display << "7I77I777777777~:7777777777777I+????++=~?I?                                  " << endl;
		display << "7I77I777777777:=7I77777777777I?????+++=:??                                  " << endl;
		display << "7777I777777777:IIII7777777777I?????+++=:~=                                  " << endl;
		display << "                                                                            " << endl;
		display << "                                                                            " << endl;
		display << "                                                                            " << endl;
		display << "                                                                            " << endl;
		updateDisplay(display, displayVector);
		progress++;
	}
	else if (progress == 4)
	{
	
		display << noskipws; 	
		display << ".................,,....:,:~:::,..........                                    " << endl;
		display << ".................,,,..:,.~==:,:...........::,                                " << endl;
		display << ".,..............,.=::::.~+===~~::........:~,~~ \"we thought it'd be fun      " << endl;
		display << "....,...........,,::=+=++==~~=~:,........=:~~::   to kidnap your girlfriend\"" << endl;
		display << ".....,,,.,,.,,.,~?+++==+++=~=~~:,,,.....~~~~~~:                             " << endl;
		display << "..::.....,..,,?I+?+7I?+++++==~~::,......::~==~~                             " << endl;
		display << ".,:~~===~~=~===+++++?I???+==~~~::::~,...,::==~:                             " << endl;
		display << "..::~~=======++++++I++++=++=~~~~~~:::,...:~+~:~ \"some of the boys are       " << endl;
		display << "..,:~~=======+++++=++++?=====~~~~~~~:....,~:=::  having fun with her over at" << endl;
		display << " .,:~~~====~=++++==+++++++====~~~~~~~.:,.,~:~~                              " << endl;
		display << "  .,:~~~~=====++++?+?+?++++===~~~~~~.,::,,:==:           THE WAREHOUSE\"     " << endl;
		display << "  ..:~~~~======++=+++++++++~~~~~~:~~.~::,,,,.                               " << endl;
		display << "  ..,:~~~~~====+++++=++++=:::::~~~~,.~~:,,,,.                               " << endl;
		display << "  ...::~~~=~==+=+++++++~~~,:I+....,.:~~::..,.                               " << endl;
		display << "..:...,:~~=~=+++=====~:............~~~~::,.,.                               " << endl;
		display << "......  .:~~~~===~:,...............,~~::,:,..: \"what's that, TOUGH GUY?\"   " << endl;
		display << "............=.,~~~~...............,~=~:::,,,,,=~, \"you want to talk to her? " << endl;
		display << ".................,~=...........,,,~=~~~::,,,,,:==~                          " << endl;
		display << ".................~++~~......,,,.=+==~~:~:,,.:,:=+==~                        " << endl;
		display << "......,,........,:=?=~=======+++====~~:::,,,:,~??++==~                      " << endl;
		display << ".....~++::.....~::=+=~=~~~=======~~~~::,:::,:,I????++=~+=:  \"ok, hold on...\"" << endl;
		display << "....=++=...:~~==~:~++~~~~~~===~~~~~~:~~::::~:IIIII??++=+=++~                " << endl;
		display << "...~+?+.....::~~~:~=?~~~~~===~~~~::~:~:::,,~IIIIIII??+?I?I??+=::.           " << endl;
		display << ",,~+++~.......:~~:~=++=~:~~~~~~~:~~~~::::,~?IIIIIIII??II7I??II?I++=:.       " << endl;
		display << ",~+?+=.........,,::~=~::~~==~:~~~~~~~:,:,=II77777I7II?IIIII7II??????+~::.   " << endl;
		display << ".=++++..........,::::~==~::~~:~~~~:~::~:~I77777777I7III77II7I??II7???+=~:~:," << endl;
		display << ",=???+.....~~=~:,.,,:~~~~=~~~~=~~:~~::,~I77777777777III77I77IIIIIII?????+=:~" << endl;
		display << ":+?+?=...:~++?++====~:~~~~~~~~~~~::::,~I7777777777777?77II77IIIIII???I?II??+" << endl;
		display << "~+???=..=+????+==++++=::,:~~~=~~:~::,:I7777777777777777III77IIIII?I?IIIII???" << endl;
		display << "=+?++=~+???++=.....:==~:~~~~~::~::,:+I77777777777777777III77IIIIIIIIII??I???" << endl;
		display << "=++~~+????=+......?~===.:::~:~::,,~+I777777777777777I77III77III?I7I7I?I7+?II" << endl;
		display << "=~~++???+=~.::~~==~=+++~,~,:~+?+=~+III77777777777777777III77III777III7?77777" << endl;
		display << "~+++++++=~===~.++++=++=,??=??~~=+?+I7I7777777777777777III777II7777I77I77777I" << endl;
		display << "~??+~===+++??+,+++++=::???=??=~==+III???77777777777777I77777I7777I777777777I" << endl;
		display << "~+=~+??+++++=~,=~~=++=,+??==??~++III+IIIIII777777777II77777I7777I7?77777II77" << endl;
		display << "==~~+?=~=~~~===~===~=+~,??=???~?II?+IIII7III7I77777I777777777777I?7777777777" << endl;
		display << "=~~~===+?++++++=+++=~~~,??=???~?I??+IIIIII777II?777I777777I77777I77I777777 7" << endl;
		display << "                                                                            " << endl;
		display << "                   *Warehouse Gangster Boss-Man*                            " << endl;
		display << "                                                                            " << endl;
		updateDisplay(display, displayVector);
		progress++;
	}
	else if (progress == 5)
		{	
		display << noskipws; 	
		display << "      777I?+=+++,+++=?+~~===+++==+++?+++++++++++++++++++++~~~====~=~~+77    " << endl;
		display << "     77 7I+=++=:=++=?=~~==+++++++++++?+++==++++?++++++=++++~~~~~~~~~=~I77777" << endl;
		display << "     7777I?++=:~=+=?==~==++++++?+?+++++?+++==++?+?+++++===+=~:=~~::~~=~I7777" << endl;
		display << "   777777I??=,~~+=++=:~==++++++????+++++?++++===++++++++~~==~::~~:~:~~~~?777" << endl;
		display << "     7777I+=:~=+=++~~~===+++++??????++++++?++++===++++====~~~~:::~~:=~~~:?I7" << endl;
		display << "77777777I?=::==+=++~~~===+++??????????+++++??++=+==+====~=~:~~~::::::~~~~:?7" << endl;
		display << "77777777?+~:=~===+=~~~~=++++????????????+?+?+?+===~===~~~:~~:=~:,::::::~~:~?" << endl;
		display << "7777777I+=:=~+====~:~~~==++++?????????????????++=======~~~~~~:~~~:,:::::~~:=" << endl;
		display << "   77 7??~=:===:~==~=:~==++++???????????????????++=====~=~~:~~~:~~~:::~~~~~~" << endl;
		display << "777  77++=~~==:~=+:=::~~=++++?????????????????+????++==~~~::~~~~~~,,,:,:?~++" << endl;
		display << "     77+=~~==~=~==:~~::~=++++??++??++++==++==++++????+=~:,,,,~~=~~,..:::~~I?" << endl;
		display << "7777777=+:~==:~:=::::::=+++++=======~:::::~=+=+??????+=~~,...:,,,:,,,::~=~??" << endl;
		display << "7777777?+~=~,:,:=~:,:,~=++=+++++++==:::::=++==+???I?+==:.,::,++==~=::::~~===" << endl;
		display << "    777+=+:,::::~,..,,=++++++==,:.,:,?7?+~=++=++??I?+++==~+++=~~=++:::::~=+=" << endl;
		display << "     77?=~::~,.,.....:=+++++=~.,~,:.::I?++=??++++????++++++====++++~:::,~=++" << endl;
		display << "777777I==:~.........,~++++++=~~~+=,:,???+??I??+++????+++?+????++++++~:~::+~+" << endl;
		display << "777777?+=~..........,=++?????++==~=~==+++?????++++????++??+????????+=~::::++" << endl;
		display << " 7777I+=:..,,........=++????????++++++???????????++????+???????????+=~::::=I" << endl;
		display << "7777I?+~,.,,,,,,.....~+++???????????????????????++++???++?????????++==~:::=I" << endl;
		display << "7777I?+::.,,,,.,,...,.=++?????????I?????????????++++????+?????????++~==~:~=+" << endl;
		display << "777I?+~~~,,,,,,..,...,,=+++?????III???II?III???++++??????+?????+++++~==~~===" << endl;
		display << "777I++~~=::,,,,,.,,,,...=++?????????I??IIII???++++++?????++????+++++~===?=II" << endl;
		display << "77I++=+==~,,,,,,,.,...??+=+++????????????I???+++++++++??+=+????+++++~===+?7?" << endl;
		display << "77+=~??+~~.,:,.,,,.,,+???.:++++??????????????+=++=.,:====++?????+++=~==I?7??" << endl;
		display << "77+==I?+~=:.,,,..,,,,????:,:++++??????????????+===++==+++++++???+++=~==+?7?I" << endl;
		display << "77?=+7+=~~,,.,,?I+:.+????~,.~=++++??????????????????????++??+???+++=~~==?I?7" << endl;
		display << "777?++++~,=,...???++??I??....~=++++++????????????????????+++++++??+~:~~=++=+" << endl;
		display << "777?+?????~::..++~+=+?I??..,..:=++++++??????????????????===++++++++~~~~=+=I7" << endl;
		display << "7777?+??I?+++~.===++?II??..=+++??+=+++???????+??++===~~::,~~=+++++=~~~~+==~7" << endl;
		display << "77 777I??I?=~::==+++?II?++????+++=:~+++??++++++=~~::~=~...,::+++++~,~~~+=~::" << endl;
		display << "777  777?++=~:,,+=+??I?+??I?++=~,.,:~+++++++=~:,.,,:~~++~~=+=+++++~,:~+~~~~:" << endl;
		display << "    7777??=~:::++~++?+??I??=,.....,:=++??+=+===+===++=++?+==++++~~,~=~~:~~~ " << endl;
		display << "777777   7I+=:,=??~+++??I??+,,,,,,,,:~=++++++=+====++++===~=++++=:~=:,,~~~:~" << endl;
		display << "         777?=:++?++?????++,...,,,,++++++================~=+++++~=~:,,,,,~~:" << endl;
		display << "          777+~+++=+??I??=.......~??I??+=~~~~~=====++++??++++++~~~,:,,,,,,, " << endl;
		display << "77777     777=++++==+?I++:.....~==??++~,~~~~~~==++????????++++~:::,,,,,,,,,~" << endl;
		display << "7777      77?==++==+??I??+...,~+??+++,...~~~~~==+++?????+++++:::~:,,,::::~~7" << endl;
		display << "          I??=++?++++?I??+....++++++=,:~.,:::~~==+++++++++++~::~,,:::~=~~=  " << endl;
		display << " " << gfName << "!!!!" << endl;
		display << "             ...." << myName << "!   Please HURRY! I don't know wh-" << "             " << endl;
		updateDisplay(display, displayVector);
		progress++;
	}
	else if (progress == 6)
	{	
		display << noskipws; 	
		display << ".................,,....:,:~:::,..........                                   " << endl;
		display << ".................,,,..:,.~==:,:...........::,                               " << endl;
		display << ".,..............,.=::::.~+===~~::........:~,~~                              " << endl;
		display << "....,...........,,::=+=++==~~=~:,........=:~~::                             " << endl;
		display << ".....,,,.,,.,,.,~?+++==+++=~=~~:,,,.....~~~~~~:                             " << endl;
		display << "..::.....,..,,?I+?+7I?+++++==~~::,......::~==~~                             " << endl;
		display << ".,:~~===~~=~===+++++?I???+==~~~::::~,...,::==~:                             " << endl;
		display << "..::~~=======++++++I++++=++=~~~~~~:::,...:~+~:~                             " << endl;
		display << "..,:~~=======+++++=++++?=====~~~~~~~:....,~:=::                             " << endl;
		display << " .,:~~~====~=++++==+++++++====~~~~~~~.:,.,~:~~                              " << endl;
		display << "  .,:~~~~=====++++?+?+?++++===~~~~~~.,::,,:==:                              " << endl;
		display << "  ..:~~~~======++=+++++++++~~~~~~:~~.~::,,,,.                               " << endl;
		display << "  ..,:~~~~~====+++++=++++=:::::~~~~,.~~:,,,,.   \"she sounds pretty scared.\" " << endl;
		display << "  ...::~~~=~==+=+++++++~~~,:I+....,.:~~::..,.      \"... for good reason...\" " << endl;
		display << "..:...,:~~=~=+++=====~:............~~~~::,.,.                               " << endl;
		display << "......  .:~~~~===~:,...............,~~::,:,..:                              " << endl;
		display << "............=.,~~~~...............,~=~:::,,,,,=~, \"if you ever want to     " << endl;
		display << ".................,~=...........,,,~=~~~::,,,,,:==~    see her again you     " << endl;
		display << ".................~++~~......,,,.=+==~~:~:,,.:,:=+==~    you need to come    " << endl;
		display << "......,,........,:=?=~=======+++====~~:::,,,:,~??++==~   to the warehouse   " << endl;
		display << ".....~++::.....~::=+=~=~~~=======~~~~::,:::,:,I????++=~+=: tonight... alone." << endl;
		display << "....=++=...:~~==~:~++~~~~~~===~~~~~~:~~::::~:IIIII??++=+=++~                " << endl;
		display << "...~+?+.....::~~~:~=?~~~~~===~~~~::~:~:::,,~IIIIIII??+?I?I??+=::.  \"hello?\" " << endl;
		display << ",,~+++~.......:~~:~=++=~:~~~~~~~:~~~~::::,~?IIIIIIII??II7I??II?I++=:.       " << endl;
		display << ",~+?+=.........,,::~=~::~~==~:~~~~~~~:,:,=II77777I7II?IIIII7II??????+~::.   " << endl;
		display << ".=++++..........,::::~==~::~~:~~~~:~::~:~I77777777I7III77II7I??II7???+=~:~:," << endl;
		display << ",=???+.....~~=~:,.,,:~~~~=~~~~=~~:~~::,~I77777777777III77I77IIIIIII?????+=:~" << endl;
		display << ":+?+?=...:~++?++====~:~~~~~~~~~~~::::,~I7777777777777?77II77IIIIII???I?II??+" << endl;
		display << "~+???=..=+????+==++++=::,:~~~=~~:~::,:I7777777777777777III77IIIII?I?IIIII???" << endl;
		display << "=+?++=~+???++=.....:==~:~~~~~::~::,:+I77777777777777777III77IIIIIIIIII??I???" << endl;
		display << "=++~~+????=+......?~===.:::~:~::,,~+I777777777777777I77III77III?I7I7I?I7+?II" << endl;
		display << "=~~++???+=~.::~~==~=+++~,~,:~+?+=~+III77777777777777777III77III777III7?77777" << endl;
		display << "~+++++++=~===~.++++=++=,??=??~~=+?+I7I7777777777777777III777II7777I77I77777I" << endl;
		display << "~??+~===+++??+,+++++=::???=??=~==+III???77777777777777I77777I7777I777777777I" << endl;
		display << "~+=~+??+++++=~,=~~=++=,+??==??~++III+IIIIII777777777II77777I7777I7?77777II77" << endl;
		display << "==~~+?=~=~~~===~===~=+~,??=???~?II?+IIII7III7I77777I777777777777I?7777777777" << endl;
		display << "=~~~===+?++++++=+++=~~~,??=???~?I??+IIIIII777II?777I777777I77777I77I777777 7" << endl;
		display << "                                                                            " << endl;
		display << "                   *Warehouse Gangster Boss-Man*                            " << endl;
		display << "                                                                            " << endl;
		updateDisplay(display, displayVector);
		progress++;
	}
	else if (progress == 7)
	{
	
		display << noskipws;
		display << "                                                                            " << endl;
		display << "    *Phone Drops*                                                           " << endl;
		display << "                                                                            " << endl;
		display << "                           ~~~,:::....:?,+++~I?+II77 77I??I=++==            " << endl;
		display << "                             7~~~~~::,....,=.+=~=7=.=I=7I7??+=I~++~~7       " << endl;
		display << "                             7=~~~~~::::,..,=.++?~=?+,,I=+7:~I?~+=:~~7      " << endl;
		display << "                              ==~~~~~~:::::..=~.+~,::=? I?+I7=~+==~~~~I7    " << endl;
		display << "                              ?=~~~~~~:,::::,,==~.~??:::~~::~=??=.~~~~~+7   " << endl;
		display << "                              7~:~,,.....,:::,:====~:.,~=++==,.:,,,,,,,,I   " << endl;
		display << "                               7I:~,:.~,...:::.:==~~~~~::,,,,...,.......:   " << endl;
		display << "                                 7:,.,:::,...,:.,:::,,,,...........,,,,:~   " << endl;
		display << "                                 :.,,~,,,::,...,...........,,,,,,,,,,,::=   " << endl;
		display << "         7=+~,?=               77:..~??=,,,,.........,,,,,,,,,,,,,,,,,,?7   " << endl;
		display << "       7=.,.....:,~7     7 77  ,~,..+I777+:,,:::,,,,,,,,,,,,,,,,,,::=?777   " << endl;
		display << "      7 ..,~,,,,,,==77 =?~,,,,:=?:,+7    7 I~,,:,,,,,,,,,,,,,:~=?77 7       " << endl;
		display << "       ,.,:7   7,?.,.++,,??+?.??:,++         7=:,,,,,,,:~+I7777             " << endl;
		display << "     7:.,,77    7+77~?~+?????II+=?,=?7         7?==+?777 7                  " << endl;
		display << "     :.,,7         7:?~=,=~++?.??.?:?=7                                     " << endl;
		display << "     ?,.,,77       I,=+=====:~=~=++=?~                                      " << endl;
		display << "     7,,,,,,~?777?:,~.~?==~~.~:~~=++::7      \"are you still there?...\"      " << endl;
		display << "        ,,=.,..,:..,~:,.:=?+++++?=:,~?                                      " << endl;
		display << "         7I,,.,.,,.,~::,,,........::=:                                      " << endl;
		display << "             7?=:~?7 ,::,,,,,,....,~,+                                      " << endl;
		display << "         77I??I77    7=,,,,,,,.....:,,7             \"i guess he's already   " << endl;
		display << "         777          7?:,,,,,......,,?7                    on his way.\"    " << endl;
		display << "                        7?,,,.....,,:=+~                                    " << endl;
		display << "                          ~::...,~~:,,:==~7                  777777         " << endl;
		display << "                        777+,,.......,:=++==7          7 ?=?+==~~~==~+      " << endl;
		display << "                      77II?+=,,,.....,~+++++=:7    77~??====~~:,:,,:::=:7   " << endl;
		display << "                     77I??+==~:,,,.,=++=++++?+==7 7~+?++====~~:,,::,::~=:7  " << endl;
		display << "\"GET READY, BOYS!..\" 77I??++==~~,,,,..:++=++++++==:====+++++?+=~:,::,~+=,7  " << endl;
		display << "                     777II??+++=~,,,,...~++==+~+=::::::~===~=~~,::,~??:.~7  " << endl;
		display << "                       77777III?+=~,,,,,.,~++++++:,:~:~~~==~~~~~+?+~...:~+7 " << endl;
		display << "                          7777777I?=:,,,:..,=++++,~.,,:~~~=~===:,......,:=7 " << endl;
		display << "                                777I?=:,,::,.,+++,~::,,................,:,7 " << endl;
		display << "                                   777?+:,,:::.,:.=::,,,,..............,,7  " << endl;
		display << "                                     777?=,,,,::,:~~:,,,,..............~+7  " << endl;
		display << "                                        77?=:,,,::::,.,,,..........,::~+7   " << endl;
		display << "                                         77I?=:,,,,::~:,,,,..,,,,,,::~+7    " << endl;
		display << "                                           777?=:,,,,:~:,,,,,,,,,,::~+7     " << endl;
		display << "                                              7I+=:,,,,::,,,,,,,,,:=77      " << endl;
		updateDisplay(display, displayVector);
		progress++;
	}
	else if (progress == 8)
	{
	
		display << noskipws; 
		display << "+?+??+?????++++=,,.....,,,,:.....:::::::::::::,,,,,,,,,,,,,::::,,,,,,,,,,,,," << endl;
		display << "++?==++?+I?=?+?+:,.:===~?,,,..,:::::::::::::,,,,,,,,,::::,,,,,,,,,,,,,,,,,,," << endl;
		display << "IIIIIIIIIIIII~,,,.......,,,.,::::::::::::::::::,:::::::,,,,,,,,,,,,,,,,,,,,," << endl;
		display << "IIIIIIIIIII7,,,.,..........:~,:::~::::::::::::::::~:::::::,,,,,,,,,,,,,,,,,," << endl;
		display << ":::::::::::,:,,,,........,,,:~::~~~~~~::::::::~,::,,=::,,,,,,,,,,,,,,,,,,,,:" << endl;
		display << "~~~~~~~~~~I:,,.,,,,......,,.,,:::=~~~~~~~~~~?=~=?:..,::::,,,,,,,,,:::::::,::" << endl;
		display << "~~~~~~~~~=:,,:.,........~~~=.,,,,:~=========~,,~:~+?:=================~==~==" << endl;
		display << "=========::,,.,........=+++++?..,,:,=+====++,,~:,,=:=::~~====~~~::::::::::::" << endl;
		display << "~~~~====..,,,,,.......::~+III77=....,:~::I:,7.,...,?..+:::~~:::::::,,,,:,:::" << endl;
		display << "~7?,::,,,.,,.:,.,,,.,,:....,,.~+===:,,,,:.,::~,,,,,.:=+7?::::::,,,,,,,,,,,,," << endl;
		display << ",,,,,::,.,,,..,,.,,,,,,,............,,..,....=++,,,,.,=,=7:::::,,,,,,,,,,,,," << endl;
		display << ".,,,,,,,,.....,,,,:,,,,,,,::,,:,....,....,,..,,.,,,,.,,:I,7,:::::::::::::~~~" << endl;
		display << "....=,:~:........,,,,,,,.,,~::,,.:+~~~~:,,...,7~+=,,...,:=I.+==++++++???????" << endl;
		display << ",,......,,,............,,,,..,,,,,,:~++=.~,,,,,,,,...,,,...?7?++++++++++??++" << endl;
		display << "::,::~..~,..........,,,.:......,.,,,,,,,,,,,,,,,,,,,,.,,,,..,~???+++++++????" << endl;
		display << "?++:==:7,.7~,..,,:,,...........,,,,,,,,,,,,,,,,,,,:=,,,,,,:,=+++++++++=+====" << endl;
		display << "==+====,7,,,,,.,:,::.........,,,,,,,,,,......,,..........++++++++===========" << endl;
		display << "=++=777+.,:,,~:,.:,,.......,.,,,,,,..,,.....................I===============" << endl;
		display << ",,.=,,=,,:~,~:..~,.,.....,....:7,,,...................,,,,,,,.,.============" << endl;
		display << "..,,..,,:,:,,,,...,...:.=+??,+:.,...................::,::,....:::===========" << endl;
		display << ".,,.,,,.,:,.=+,,,.,,,=.???????,,,...................:.,,,,...:,,,:+=========" << endl;
		display << "=~+==.II7?,+:~:,.,.,,=,+????+,:,,,....:............:.~~,::++=:.:,,:+========" << endl;
		display << ".I777=,.+I:,::,.,==,?=.,~=~,.....................,..,,~,,,~+++=.:,,,++++====" << endl;
		display << "77?,....?I~:=:,?,+.,,,?~~~........,,.............~,,,,,:.,~~?+~~.,,,:?++++++" << endl;
		display << "7II7I?++=~:,::~+?+..,,..,.......................=,,:,:,:?.,::?+~,:,,,++++===" << endl;
		display << "7?,==,...,,:,I+++.....,...........,.............+.,::..,,.:,:+++::,,,???????" << endl;
		display << ":,:~=,,........,,,...................:........,:=.==:~.,,,.=~+=+.,,,,+++++++" << endl;
		display << ",,,=~:,....................................+..,,.=~=+=:,~~~++===:,,,,+++++++" << endl;
		display << ":=~,,,.....................................==..,,.==~=++++++:=+,.,,,====++++" << endl;
		display << "=~~:,....==...............................====..,,:,:~~:~~~=+,,,,,,?????????" << endl;
		display << "::,,....III~,,,........,,:~=+??I?I???I?????????...,,,~...,,:,,,..,I???I?????" << endl;
		display << ",,....~??????????????????????????????????????????....,,,,,,.....????????????" << endl;
		display << "....,??????????????????????????????????????????????~.........~??????????????" << endl;
		display << "                                                                            " << endl;
		display << "         You ride off into the night like a bat outta hell...               " << endl;
		display << "                                                                            " << endl;
		display << "     If those goons have harmed one hair on " << gfName << "'s head you're  " << endl;
		display << "                                                                            " << endl;
		display << "             going to destroy every last one of them.                       " << endl;
		display << "                                                                            " << endl;
		updateDisplay(display, displayVector);
		progress++;
	}
	else if (progress == 9)
	{
	
		display << noskipws;
		display << "                                                                             " << endl;
		display << "          Your blood is boiling by the time you reach the warehouse.         " << endl;
		display << "   As you open the gate, you almost feel sorry for the hapless punks inside. " << endl;
		display << "                    They don't know what they got comin'                     " << endl;
		display << "                                                                            " << endl;
		display << ".        .  ..:,...,...,,.,:,,,,,,,,,,,,:............,,,~,,,::,,,.,.. .     ." << endl;
		display << ".  .     ,,,,::.,,,::,,,,,:,,,,,::,,,,,:,,,,,::,,,.:,::,,,:,~,,,,,,,.       ." << endl;
		display << "..   . . ,:,,,,::,:,,,,,:,:::::::~:::::~,,:,:~:::,::,:,,,:,,~:.:,,,,.   .  .." << endl;
		display << ".  . .. .,:::.,,,:.,,,,,,,,,~::=I:,:,,,:,,,:,,,,:,,,~+7:::::~~,,,,,:.   ..  ." << endl;
		display << ". .  . ..:==,,,,,,:,,,,:,:::::,:~::::::::::::::::~~::~~~,:::=~:::,:, . . .. ." << endl;
		display << ".. . . ..............,,.....,,,,,,,,,,..,..,,,,,,,,,:~,,,,,.,+=,.,,.I . .. .." << endl;
		display << ".. . .. ,,:,,,,,,:,,,:,,,,,,,:::~7::::,:,:::::,,:::,?:,,,,:,==,,,:,:7.. .. .." << endl;
		display << ". ... ..,:,,,.:,,,,,,,,,,,,:::::::::,,,,,,,,,,,:,:::I,:,~:::~=,,,::,:.. ... ." << endl;
		display << "........:::::::::~~:::~::::::::::~7:::::::::,::,::I:?.,,,,,::=,:7+,:,........" << endl;
		display << "..........,:,,,,,,,,:::,:::::::::::::,,,,,,,...::::,?,,,,,:,.=,:::,,:........" << endl;
		display << "........,,,::,,,..,,,.,:,,,,::::::~::::,,,,,:,,::+:,=~..:::~,+,::,:,,........" << endl;
		display << "........7::::,,,,,:,,::,,::,:,::::::::::::::,,:,,I,,~=:::::,:+:,,,,,=........" << endl;
		display << "........:,,~,:,:,~:,::::,,::::::::~:::::::::::,::7:::+::::,::?:,.:,.=........" << endl;
		display << ".........,,~,,::7=::,:,:,:,,,,:,::::=::::::::~~~:7::,I~::::,,?+..,,,+,......." << endl;
		display << "........:,,:I,,::+:,~~::::,:::,,::::::::::::~:,=:I:=.?,,:,7,,?+.:::~,,......." << endl;
		display << "........=:::,::::+:::=:?:::,:::+::::::::::::=::+:I::,I::,::,:=+~~:=+:,......." << endl;
		display << ".......,+~=??+~~++?+~++??+~:~~+??+~~+??+==+?I?=+++?+:??I?+~:=++,:~=~=+,,....." << endl;
		display << ".......:=++???++???+++??++=~=+????+=??..++??I?+?++?+=???++=~~~+.+I?+++,:,,::." << endl;
		display << ".......==++++++==++=++++++=~++++++++++..?+?+??++++++=?++====,:+~:~:::~,,,,..," << endl;
		display << ".......+=+++++===++=++++++=~++++++++?~...++???++++++=?++====~=+=~~??~=...,,.." << endl;
		display << ".......+==+==.===,+=++==+++~++++++++......~=?=+++++++I++======++==~~++,,,,,.," << endl;
		display << ".......+++++++++++++++++++?????????I.......+?+++++????????????=+++?+??~.,,,,." << endl;
		display << ".......?+++++++??++?????????????????.......???????????????+??+?++?+?++=..,..:" << endl;
		display << ".......?+++?????????????????????????.......?+++?+++++++++??++++=??+++??...,.." << endl;
		display << ".......++++++++++??++++++++???+?++++,.....?++++++++++++++++?+++=?+==++?,:,..." << endl;
		display << ".......++++++++++++++++++++++++++=+++..?..========++===++==++===+=++++=.:,,,:" << endl;
		display << ".......==============+==============~..=..================++=~=+~~~~=+=,:,,::" << endl;
		display << ".......=~====~======================,..=..=~========~~====~==~=~+===++=,:,,,:" << endl;
		display << ".......===~~~~~~~~~======~~~~~~~~~~~..~~..~~=~~=~~~~~~~~~=~==~~~======+::,,,." << endl;
		display << "......,=~~~~~~~~~~~~~~~~~~~~~~~~~~~~..~~~..=~~~~~~~~~~~~=~~~~~~~~~~~~=~,,...." << endl;
		display << ".....:::::::~~:~~~~~~~~~~~~~~~~~~~~:..~~~...~~~~~~~~~~~~~~~~~~~~~::::::::...." << endl;
		display << "...........,::,,::::::::::::::::::::::::::,,,:::::::::::::::::::,,::,..,,...." << endl;
		display << "........,,,,,,,,::::::::::::::::::::::::::::,:,,::::::::::::::::,,,,,,,,....." << endl;
		display << "......,,,,,,,,,,,,,:::::::::::::::::::::::,:,,::::::::::::::=,,,,,,,,,,,,,..." << endl;
		updateDisplay(display, displayVector);
		progress++;
	}	
}



void levelUp(Player * p1, int & iMaxHealth, vector<string> & vLog, int & iChain)
{
	ostringstream log;
	if (((p1->getLevel() == 1)&&(p1->getExperience() > 25))||((p1->getLevel() == 2)&&(p1->getExperience() > 95))||
		((p1->getLevel() == 3)&&(p1->getExperience() > 245))||((p1->getLevel() == 4)&&(p1->getExperience() > 505))||
		((p1->getLevel() == 5)&&(p1->getExperience() > 905))||((p1->getLevel() == 6)&&(p1->getExperience() > 1475))||
		((p1->getLevel() == 7)&&(p1->getExperience() > 2280))||((p1->getLevel() == 8)&&(p1->getExperience() > 3320))||
		((p1->getLevel() == 9)&&(p1->getExperience() > 4500))||((p1->getLevel() == 10)&&(p1->getExperience() > 6000)))
	{
		p1->setLevel(p1->getLevel() + 1);
		p1->setHealth(iMaxHealth + (5 * p1->getLevel()));
		iChain++;
		log << "You Leveled Up! Max Health now " << p1->getHealth() << ". DMG Increased. Chain Turns + 1";
		vLog.push_back(log.str());
		
	}
	
}

void displayLog(vector<string> vLog, int & prevSize, stringstream & display)
{
	display << "____________________________________________________________________________" << endl;
	int i = vLog.size() - prevSize;
	if (i == 0)
	{
		display << vLog[vLog.size() - 1] << endl;
		display << vLog[vLog.size() - 2] << endl;
		display << vLog[vLog.size() - 3] << endl;
		display << vLog[vLog.size() - 4] << endl;
	}
	if (i == 1)
	{
		display << "->" << vLog[vLog.size() - 1] << endl;
		display << vLog[vLog.size() - 2] << endl;
		display << vLog[vLog.size() - 3] << endl;
		display << vLog[vLog.size() - 4] << endl;
	}
	else if (i == 2)
	{
		display << "->" << vLog[vLog.size() - 1] << endl;
		display << "->" << vLog[vLog.size() - 2] << endl;
		display << vLog[vLog.size() - 3] << endl;
		display << vLog[vLog.size() - 4] << endl;
	}
	else if (i == 3)
	{
		display << "->" << vLog[vLog.size() - 1] << endl;
		display << "->" << vLog[vLog.size() - 2] << endl;
		display << "->" << vLog[vLog.size() - 3] << endl;
		display << vLog[vLog.size() - 4] << endl;
	}
	else if (i > 3)
	{
		display << "->" << vLog[vLog.size() - 1] << endl;
		display << "->" << vLog[vLog.size() - 2] << endl;
		display << "->" << vLog[vLog.size() - 3] << endl;
		display << "->" << vLog[vLog.size() - 4] << endl;
	}
	prevSize = vLog.size();
}

string bridgeInv (int i)
{
	ostringstream line;
	if (i >= 1000)
	{
		line << i << " ||";
		return line.str();
	}
	else if (i >= 100)
	{
		line << " " << i << " ||";
		return line.str();
	}
	else if (i >= 10)
	{
		line << "  " << i << " ||";
		return line.str();
	}
	else if (i >= 0)
	{
		line << "   " << i << " ||";
		return line.str();
	}

}

string manageInventory(char pInput, int & curSel, int & curCon, int & curScore, Player * p1, vector<Weapon*> & m_wVec, 
					   vector<Armor*> & m_aVec, vector<Consumable*> & m_cVec, vector<string> & logV, DungeonLevel & dung, 
					   int & iCurFloor, int & curChain, string gfName, bool & shottyToggle, int & maxHealth)
{
	ostringstream lines;
	lines.str("");
	ostringstream log;
	string sPossible;
	int iPossible;
	if (pInput == '5')
	{
		if(dung.getVector()[p1->getPosX()][p1->getPosY()].get_holdsWeapons() == true)
		{
			Weapon * topW = dung.getVector()[p1->getPosX()][p1->getPosY()].getWeaponVec().back();
			m_wVec.push_back(topW);
			p1->setWeaponSlot(topW);
			dung.getVector()[p1->getPosX()][p1->getPosY()].pickupWeapon();
			log << "You picked up and equipped the " << topW->getName();
			logV.push_back(log.str());
		}
		else if(dung.getVector()[p1->getPosX()][p1->getPosY()].get_holdsArmors() == true)
		{
			Armor * topA = dung.getVector()[p1->getPosX()][p1->getPosY()].getArmorVec().back();
			m_aVec.push_back(topA);
			p1->setArmorSlot(topA);
			dung.getVector()[p1->getPosX()][p1->getPosY()].pickupArmor();
			log << "You picked up and equipped the " << topA->getName();
			logV.push_back(log.str());
		}
		else if(dung.getVector()[p1->getPosX()][p1->getPosY()].get_holdsConsumables() == true)
		{
			Consumable * topC = dung.getVector()[p1->getPosX()][p1->getPosY()].getConsumableVec().back();
			if (topC->getWeight() == 1)
			{
				curCon = 0;
				m_cVec[0]->setQuantity(m_cVec[0]->getQuantity() + 1);
			}
			if (topC->getWeight() == 2)
			{
				curCon = 1;
				m_cVec[1]->setQuantity(m_cVec[1]->getQuantity() + topC->getQuantity());
			}
			if (topC->getWeight() == 0)
			{
				curCon = 2;
				m_cVec[2]->setQuantity(m_cVec[2]->getQuantity() + 1);
			}
			if (topC->getWeight() == 3)
			{
				curCon = 3;
				m_cVec[3]->setQuantity(m_cVec[3]->getQuantity() + 1);
			}

			dung.getVector()[p1->getPosX()][p1->getPosY()].pickupConsumable();
			log << "You picked up " << topC->getName() << " x" << topC->getQuantity();
			logV.push_back(log.str());
		}
		else if(dung.getVector()[p1->getPosX()][p1->getPosY()].getSymbol() == '>')
		{
			if((m_cVec[2]->getQuantity() > 0)&&(dung.getstairsUnlocked() == false))
			{
				log << "You have the Stairwell keys. You just need to use them.";
				logV.push_back(log.str());
			}
			else if(dung.getstairsUnlocked() == true)
			{
				iCurFloor++;
				log << "You're at the stairwell entrance. Move to go up.";
				logV.push_back(log.str());
			}
			else if(m_cVec[2]->getQuantity() == 0)
			{
				log << "The stairwell is locked. One of the punks on this floor must have the keys.";
				logV.push_back(log.str());
			}
		}
		else if(dung.getVector()[p1->getPosX()][p1->getPosY()].getSymbol() == '<')
		{
			if (iCurFloor == 0)
			{
				log << "You can't leave now! They still have " << gfName << "!"; 
				logV.push_back(log.str());
			}
			else
			{
				iCurFloor--;
				log << "You're at the stairwell entrance. Move to go down.";
				logV.push_back(log.str());
			}
		}
	}
		
	if(pInput == '9')
	{
		if (curSel == 2) {curSel = 0;}
		else {curSel++;}		
	}
	if(pInput == '7')
	{
		if (curSel == 0)
		{
			Weapon * lastW = m_wVec.front();
			for (int i = 0; i < m_wVec.size() - 1; i++)
			{
				m_wVec[i] = m_wVec[i + 1];
			}
			m_wVec[m_wVec.size() - 1] = lastW;
			p1->setWeaponSlot(m_wVec.back());
		}
		if (curSel == 1)
		{
			Armor * lastA = m_aVec.front();
			for (int i = 0; i < m_aVec.size() - 1; i++)
			{
				m_aVec[i] = m_aVec[i + 1];
			}
			m_aVec[m_aVec.size() - 1] = lastA;
			p1->setArmorSlot(m_aVec.back());
		}
		if (curSel == 2)
		{
			if (curCon == 3) {curCon = 0;}
			else {curCon++;}
		}
	}
	if(pInput == '0')
	{
		if (curSel == 0)
		{
			if (m_wVec.back()->getWeaponType() == 3)
			{
				int i = m_cVec[1]->getQuantity();
				curCon = 1;
				if (!(i <= 1))
				{
					if (m_wVec.back()->getWeaponType() == 3)
					{
						sPossible = "Some Shells";
						m_cVec[1]->setQuantity(i - 2);
						shottyToggle = true;
						log << "Which direction you gonna shoot? Use movement keys...";
						logV.push_back(log.str());
					}
				}
				else
				{
					log << "You're out of ammo!";
					logV.push_back(log.str());
				}

			}
			else if (m_wVec.size() > 1)
			{
				sPossible = m_wVec.back()->getName();
				iPossible = m_wVec.back()->getValue();
				curScore += iPossible;
				m_wVec.pop_back();
				p1->setWeaponSlot(m_wVec.back());
				log << "You sold " << sPossible << " for $" << iPossible << ". You now have: $" << curScore << ".";
				logV.push_back(log.str());
			}
		}
		if (curSel == 1)
		{
			if (m_aVec.size() > 1)
			{
				sPossible = m_aVec.back()->getName();
				iPossible = m_aVec.back()->getValue();
				curScore += iPossible;
				m_aVec.pop_back();
				p1->setArmorSlot(m_aVec.back());
				log << "You sold " << sPossible << " for $" << iPossible << ". You now have: $" << curScore << ".";
				logV.push_back(log.str());
			}
		}
		if (curSel == 2)
		{
			if(curCon == 0)
			{
				int i = m_cVec[0]->getQuantity();
				if (!(i <= 0))
				{
					sPossible = "The Sauce";
					m_cVec[0]->setQuantity(i - 1);
					iPossible = p1->getHealth();
					p1->setHealth(iPossible + (15 * p1->getLevel()));
					if (p1->getHealth() > maxHealth) 
					{
						p1->setHealth(maxHealth);
						log << "You drank " << sPossible << " and are now at max Health. " << (m_cVec[0]->getQuantity()) << " remaining.";
						logV.push_back(log.str());
					}
					else
					{
						log << "You drank " << sPossible << " and gained " << (15 * p1->getLevel()) << " health. " << (m_cVec[0]->getQuantity()) << " remaining.";
						logV.push_back(log.str());
					}
				}
			}
			if(curCon == 1)
			{
				int i = m_cVec[1]->getQuantity();
				if (!(i <= 1))
				{
					if (m_wVec.back()->getWeaponType() == 3)
					{
						sPossible = "Some Shells";
						m_cVec[1]->setQuantity(i - 2);
						shottyToggle = true;
						log << "Which direction you gonna shoot? Use movement keys...";
						logV.push_back(log.str());
					}
					else
					{
						log << "You need to equip a shotty to use these.";
						logV.push_back(log.str());
					}
				}
			}
			if(curCon == 2)
			{
				if(dung.getVector()[p1->getPosX()][p1->getPosY()].getSymbol() == '>')
				{
					if((m_cVec[2]->getQuantity() > 0)&&(dung.getstairsUnlocked() == false))
					{
						m_cVec[2]->setQuantity(0);
						dung.setstairsUnlocked(true);
						iCurFloor++;
						log << "You used the Stairwell Keys and unlocked the next floor. Move to go up.";
						logV.push_back(log.str());
					}
				}
				else if(m_cVec[2]->getQuantity() == 0)
				{
					log << "Got no keys and no place to go...";
					logV.push_back(log.str());
				}
				else
				{
					log << "Can't use those here. Need to find the stairwell to the next floor: [>]";
					logV.push_back(log.str());
				}
			}
			if(curCon == 3)
			{
				int i = m_cVec[3]->getQuantity();
				if (!(i <= 0))
				{
					sPossible = "An Energy Drink";
					m_cVec[3]->setQuantity(i - 1);
					curChain += 2;
					log << "You drank " << sPossible << " and gained Chain x2." << (m_cVec[0]->getQuantity()) << " remaining.";
					logV.push_back(log.str());
				}
			}
		}
	}
	if (curCon == 0)
		sPossible = "Regain some Health||";
	if (curCon == 1)
		sPossible = "Shotty go BoomBoom||";
	if (curCon == 2)
		sPossible = "Unlock next floor ||";
	if (curCon == 3)
		sPossible = "Get Hype! Chain+2 ||";
	if (curSel == 0)
	{

		lines << "____________________________________________________________________________" << endl;
		lines << "||_|_|_|_|_|_|_|_|_|_|     ______________________     ______________________" << endl;
		lines << "|Current Weapon:     |     |Current Armor:      |     |Current Item:       |" << endl;
		lines << "|--------------------|     |--------------------|     |--------------------|" << endl;
		lines << "||" << (m_wVec.back()->getName()) << "||     ||" << (m_aVec.back()->getName()) << "||     ||" << (m_cVec[curCon]->getName()) << "||" << endl;
		lines << "|| Atk Bonus:  " << bridgeInv(m_wVec.back()->getAttackBonus()) << "     || Def Bonus:  " << bridgeInv(m_aVec.back()->getDefenseBonus()) << "     ||Uses:        " << bridgeInv(m_cVec[curCon]->getQuantity()) << endl;
		lines << "|| Value:      " << bridgeInv(m_wVec.back()->getValue()) << "     || Value:      " << bridgeInv(m_aVec.back()->getValue()) << "     ||" << sPossible << endl; 
		lines << "||------------------||     ||------------------||     ||------------------||" << endl;
		if (m_wVec.back()->getWeaponType() == 3)
		{
			lines << "^^ Shoot        :[0]^^     ----------------------     ----------------------" << endl;
		}
		else
		{
			lines << "^^ Sell         :[0]^^     ----------------------     ----------------------" << endl;
		}
		lines << "^^ Switch Weapon:[7]^^                                                      " << endl;
		lines << ">> Go to Armor  :[9]>>______________________________________________________" << endl;
	}
	if (curSel == 1)
	{
		lines << "____________________________________________________________________________" << endl;
		lines << "______________________     ||_|_|_|_|_|_|_|_|_|_|     ______________________" << endl;
		lines << "|Current Weapon:     |     |Current Armor:      |     |Current Item:       |" << endl;
		lines << "|--------------------|     |--------------------|     |--------------------|" << endl;
		lines << "||" << (m_wVec.back()->getName()) << "||     ||" << (m_aVec.back()->getName()) << "||     ||" << (m_cVec[curCon]->getName()) << "||" << endl;
		lines << "|| Atk Bonus:  " << bridgeInv(m_wVec.back()->getAttackBonus()) << "     || Def Bonus:  " << bridgeInv(m_aVec.back()->getDefenseBonus()) << "     ||Uses:        " << bridgeInv(m_cVec[curCon]->getQuantity()) << endl;
		lines << "|| Value:      " << bridgeInv(m_wVec.back()->getValue()) << "     || Value:      " << bridgeInv(m_aVec.back()->getValue()) << "     ||" << sPossible << endl;
		lines << "||------------------||     ||------------------||     ||------------------||" << endl;
		lines << "----------------------     ^^ Sell         :[0]^^     ----------------------" << endl;
		lines << "                           ^^ Switch Armor :[7]^^                           " << endl;
		lines << "___________________________>> Go to Items  :[9]>>___________________________" << endl;
	}
	if (curSel == 2)
	{
		lines << "____________________________________________________________________________" << endl;
		lines << "______________________     ______________________     ||_|_|_|_|_|_|_|_|_|_|" << endl;
		lines << "|Current Weapon:     |     |Current Armor:      |     |Current Item:       |" << endl;
		lines << "|--------------------|     |--------------------|     |--------------------|" << endl;
		lines << "||" << (m_wVec.back()->getName()) << "||     ||" << (m_aVec.back()->getName()) << "||     ||" << (m_cVec[curCon]->getName()) << "||" << endl;
		lines << "|| Atk Bonus:  " << bridgeInv(m_wVec.back()->getAttackBonus()) << "     || Def Bonus:  " << bridgeInv(m_aVec.back()->getDefenseBonus()) << "     ||Uses:        " << bridgeInv(m_cVec[curCon]->getQuantity()) << endl;
		lines << "|| Value:      " << bridgeInv(m_wVec.back()->getValue()) << "     || Value:      " << bridgeInv(m_aVec.back()->getValue()) << "     ||" << sPossible << endl;
		lines << "||------------------||     ||------------------||     ||------------------||" << endl;
		lines << "----------------------     ----------------------     ^^ Use          :[0]^^" << endl;
		lines << "                                                      ^^ Switch Item  :[7]^^" << endl;
		lines << "______________________________________________________>> Go to Weapons:[9]>>" << endl;
	}

	return lines.str();
}

void moveCreatures(Player * pPlayer, DungeonLevel & dung, vector<string> & logV, vector<vector<char>> & displayVector)
{
	ostringstream log;
	int x = pPlayer->getPosX();
	int y = pPlayer->getPosY();

	for (int i = 0; i < dung.getVector().size(); i++)
	{
		for (int j = 0; j < dung.getVector()[i].size(); j++)
		{
			
			if (dung.getVector()[i][j].get_holdsCreature() == true)
			{
				if (dung.getVector()[i][j].getCreature()->isHostile() == true)
				{
					if (((dung.getVector()[i][j].getCreature()->getPosX() == x)&&((dung.getVector()[i][j].getCreature()->getPosY() == (y - 1))||(dung.getVector()[i][j].getCreature()->getPosY() == (y + 1))))||
						((dung.getVector()[i][j].getCreature()->getPosY() == y)&&((dung.getVector()[i][j].getCreature()->getPosX() == (x - 1))||(dung.getVector()[i][j].getCreature()->getPosX() == (x + 1)))))
					{
						logV.push_back(dung.getVector()[i][j].getCreature()->attack(dung.getVector()[x][y].getPlayer(), dung.getFloor(), dung.randomNumber(5)));
					}
					else  if(dung.getVector()[i][j].getCreature()->getPosX() == x)
					{
						if (dung.getVector()[i][j].getCreature()->getPosY() > y)
						{
							if(dung.getVector()[i][j - 1].getTraversable() == true)
							{
								dung.getVector()[i][j - 1].setCreature(dung.getVector()[i][j].getCreature());
								dung.getVector()[i][j - 1].getCreature()->setPosY(j - 1);
								dung.getVector()[i][j].setCreature(NULL);
								dung.getVector()[i][j].set_holdsCreature(false);
							}
						}
						else if (dung.getVector()[i][j].getCreature()->getPosY() < y)
						{
							if(dung.getVector()[i][j + 1].getTraversable() == true)
							{
								dung.getVector()[i][j + 1].setCreature(dung.getVector()[i][j].getCreature());
								dung.getVector()[i][j + 1].getCreature()->setPosY(j + 1);
								dung.getVector()[i][j].setCreature(NULL);
								dung.getVector()[i][j].set_holdsCreature(false);
								if (!((j == (dung.getVector()[i].size() - 1))||(dung.getVector()[i][j + 1].getCreature()->getName() == "Bum Rusher"))){ j++;}
								else if((i == x)&&((j + 2) == y)&&(dung.getVector()[i][j + 1].getCreature()->getName() == "Bum Rusher"))
								{
									logV.push_back("The Bum Rusher can't wait to get his ass kicked. He rushes to your position.");
								}							
							}
						}
					}
					else  if(dung.getVector()[i][j].getCreature()->getPosY() == y)
					{
						if (dung.getVector()[i][j].getCreature()->getPosX() > x)
						{
							if(dung.getVector()[i - 1][j].getTraversable() == true)
							{
								dung.getVector()[i - 1][j].setCreature(dung.getVector()[i][j].getCreature());
								dung.getVector()[i - 1][j].getCreature()->setPosX(i - 1);
								dung.getVector()[i][j].setCreature(NULL);
								dung.getVector()[i][j].set_holdsCreature(false);
							}
						}
						else if (dung.getVector()[i][j].getCreature()->getPosX() < x)
						{
							if(dung.getVector()[i + 1][j].getTraversable() == true)
							{
								dung.getVector()[i + 1][j].setCreature(dung.getVector()[i][j].getCreature());
								dung.getVector()[i + 1][j].getCreature()->setPosX(i + 1);
								dung.getVector()[i][j].setCreature(NULL);
								dung.getVector()[i][j].set_holdsCreature(false);
								if (!((i == (dung.getVector().size() - 1))||(dung.getVector()[i + 1][j].getCreature()->getName() == "Bum Rusher"))){ i++;}
								else if((j == y)&&((i+2) == x)&&(dung.getVector()[i + 1][j].getCreature()->getName() == "Bum Rusher"))
								{
									logV.push_back("The Bum Rusher can't wait to get his ass kicked. He rushes to your position.");
								}
							}
						}
					}
					else if (dung.getVector()[i][j].getCreature()->getPosY() > y)
					{
						if(dung.getVector()[i][j - 1].getTraversable() == true)
						{
							dung.getVector()[i][j - 1].setCreature(dung.getVector()[i][j].getCreature());
							dung.getVector()[i][j - 1].getCreature()->setPosY(j - 1);
							dung.getVector()[i][j].setCreature(NULL);
							dung.getVector()[i][j].set_holdsCreature(false);
						}
					}
					else if (dung.getVector()[i][j].getCreature()->getPosX() > x)
					{
						if(dung.getVector()[i - 1][j].getTraversable() == true)
						{
							dung.getVector()[i - 1][j].setCreature(dung.getVector()[i][j].getCreature());
							dung.getVector()[i - 1][j].getCreature()->setPosX(i - 1);
							dung.getVector()[i][j].setCreature(NULL);
							dung.getVector()[i][j].set_holdsCreature(false);
						}
					}
					else if (dung.getVector()[i][j].getCreature()->getPosX() < x)
					{
						if(dung.getVector()[i + 1][j].getTraversable() == true)
						{
							dung.getVector()[i + 1][j].setCreature(dung.getVector()[i][j].getCreature());
							dung.getVector()[i + 1][j].getCreature()->setPosX(i + 1);
							dung.getVector()[i][j].setCreature(NULL);
							dung.getVector()[i][j].set_holdsCreature(false);
							if (!((i == (dung.getVector().size() - 1))||(dung.getVector()[i + 1][j].getCreature()->getName() == "Bum Rusher"))){ i++;}
							else if((j == y)&&((i + 2) == x)&&(dung.getVector()[i + 1][j].getCreature()->getName() == "Bum Rusher"))
							{
								logV.push_back("The Bum Rusher can't wait to get his ass kicked. He rushes to your position.");
							}
						}
					}
					else if (dung.getVector()[i][j].getCreature()->getPosY() < y)
					{
						if(dung.getVector()[i][j + 1].getTraversable() == true)
						{
							dung.getVector()[i][j + 1].setCreature(dung.getVector()[i][j].getCreature());
							dung.getVector()[i][j + 1].getCreature()->setPosY(j + 1);
							dung.getVector()[i][j].setCreature(NULL);
							dung.getVector()[i][j].set_holdsCreature(false);
							if (!((j == (dung.getVector()[i].size() - 1))||(dung.getVector()[i][j + 1].getCreature()->getName() == "Bum Rusher"))){ j++;}
							else if((i == x)&&((j + 2) == y)&&(dung.getVector()[i][j + 1].getCreature()->getName() == "Bum Rusher"))
							{
								logV.push_back("The Bum Rusher can't wait to get his ass kicked. He rushes to your position.");
							}
						}
					}
				}
				else
				{
					if (dung.getVector()[i][j].getCreature()->getName() == "Shotgunner")
					{
						
						for (int q = (x); q < (x + 3); q++)
						{
							for (int p = (y - 1); p < (y + 2); p++)
							{
								if (displayVector[q][p] == '@')
								{
									displayVector[q][p] = '.';
								}
							}
						}
						displayVector[x + 1][y] = '@';
						char tempSymb;
						if(dung.randomNumber(3) == 1)
						{
							if((x < dung.getVector()[i][j].getCreature()->getPosX())&&(y == dung.getVector()[i][j].getCreature()->getPosY()))
							{
								if((dung.getVector()[i][j].getCreature()->getPosX() - x) < 9)
								{
									
									for (int k = 1; k < 7; k++)
									{
										if (k != 1)
										{
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() - k + 2][dung.getVector()[i][j].getCreature()->getPosY()] = tempSymb;
										}
										if (dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX() - k][dung.getVector()[i][j].getCreature()->getPosY()].get_holdsPlayer() == true)
										{
											logV.push_back(dung.getVector()[i][j].getCreature()->attack(dung.getVector()[x][y].getPlayer(), dung.getFloor(), dung.randomNumber(5)));
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() - k + 1][dung.getVector()[i][j].getCreature()->getPosY()] = 'O';
											k = 7;
										}
										else if ((dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX() - k][dung.getVector()[i][j].getCreature()->getPosY()].getSymbol() == '|')||(dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX() - k][dung.getVector()[i][j].getCreature()->getPosY()].getSymbol() == '_'))
										{
											logV.push_back("The Shotgunner shot the wall!");
											k = 7;
										}
										else if (k == 6)
										{
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() - k + 1][dung.getVector()[i][j].getCreature()->getPosY()] = 'O';
											logV.push_back("The Shotgunner fires a shot and misses. You're out of range!");
										}
										else
										{
				
										tempSymb = displayVector[dung.getVector()[i][j].getCreature()->getPosX() - k + 1][dung.getVector()[i][j].getCreature()->getPosY()];
										displayVector[dung.getVector()[i][j].getCreature()->getPosX() - k + 1][dung.getVector()[i][j].getCreature()->getPosY()] = 'o';
										}
										//Comment for nCurses
										//displaydisplayVector(displayVector);
										//cin.get();
										//Uncomment for nCurses
										updateNcurses(displayVector);
										getch();
										//millisleep(100);
									}
								}
							}
							if((x > dung.getVector()[i][j].getCreature()->getPosX())&&(y == dung.getVector()[i][j].getCreature()->getPosY()))
							{
								if((x - dung.getVector()[i][j].getCreature()->getPosX()) < 9)
								{
									
									for (int k = 1; k < 7; k++)
									{
										if (k != 1)
										{
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() + k][dung.getVector()[i][j].getCreature()->getPosY()] = tempSymb;
										}
										if (dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX() + k][dung.getVector()[i][j].getCreature()->getPosY()].get_holdsPlayer() == true)
										{
											logV.push_back(dung.getVector()[i][j].getCreature()->attack(dung.getVector()[x][y].getPlayer(), dung.getFloor(), dung.randomNumber(5)));
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() + k + 1][dung.getVector()[i][j].getCreature()->getPosY()] = 'O';
											k = 7;
										}
										else if ((dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX() + k][dung.getVector()[i][j].getCreature()->getPosY()].getSymbol() == '|')||(dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX() - k][dung.getVector()[i][j].getCreature()->getPosY()].getSymbol() == '_'))
										{
											logV.push_back("The Shotgunner shot the wall!");
											k = 7;
										}
										else if (k == 6)
										{
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() + k + 1][dung.getVector()[i][j].getCreature()->getPosY()] = 'O';
											logV.push_back("The Shotgunner fires a shot and misses. You're out of range!");
										}
										else
										{
				
										tempSymb = displayVector[dung.getVector()[i][j].getCreature()->getPosX() + k + 1][dung.getVector()[i][j].getCreature()->getPosY()];
										displayVector[dung.getVector()[i][j].getCreature()->getPosX() + k + 1][dung.getVector()[i][j].getCreature()->getPosY()] = 'o';
										}
										//Comment for nCurses
										//displaydisplayVector(displayVector);
										//cin.get();
										//Uncomment for nCurses
										updateNcurses(displayVector);
										getch();
										//millisleep(100);
									}
								}
							}
							if((x == dung.getVector()[i][j].getCreature()->getPosX())&&(y > dung.getVector()[i][j].getCreature()->getPosY()))
							{
								if((y - dung.getVector()[i][j].getCreature()->getPosY()) < 9)
								{
									for (int k = 1; k < 7; k++)
									{
										if (k != 1)
										{
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() + k - 1] = tempSymb;
										}
										if (dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX()][dung.getVector()[i][j].getCreature()->getPosY() + k].get_holdsPlayer() == true)
										{
											logV.push_back(dung.getVector()[i][j].getCreature()->attack(dung.getVector()[x][y].getPlayer(), dung.getFloor(), dung.randomNumber(5)));
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() + k] = 'O';
											k = 7;
										}
										else if ((dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX()][dung.getVector()[i][j].getCreature()->getPosY() + k].getSymbol() == '|')||(dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX()][dung.getVector()[i][j].getCreature()->getPosY() + k].getSymbol() == '_'))
										{
											logV.push_back("The Shotgunner shot the wall!");
											k = 7;
										}
										else if (k == 6)
										{
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() + k] = 'O';
											logV.push_back("The Shotgunner fires a shot and misses. You're out of range!");
										}
										else
										{
				
										tempSymb = displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() + k];
										displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() + k] = 'o';
										}
										//Comment for nCurses
										//displaydisplayVector(displayVector);
										//cin.get();
										//Uncomment for nCurses
										updateNcurses(displayVector);
										getch();
										//millisleep(100);
									}
								}
							}
							if((x == dung.getVector()[i][j].getCreature()->getPosX())&&(y < dung.getVector()[i][j].getCreature()->getPosY()))
							{
								if((dung.getVector()[i][j].getCreature()->getPosY() - y) < 9)
								{
									for (int k = 1; k < 7; k++)
									{
										if (k != 1)
										{
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() - k + 1] = tempSymb;
										}
										if (dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX()][dung.getVector()[i][j].getCreature()->getPosY() - k].get_holdsPlayer() == true)
										{
											logV.push_back(dung.getVector()[i][j].getCreature()->attack(dung.getVector()[x][y].getPlayer(), dung.getFloor(), dung.randomNumber(5)));
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() - k] = 'O';
											k = 7;
										}
										else if ((dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX()][dung.getVector()[i][j].getCreature()->getPosY() - k].getSymbol() == '|')||(dung.getVector()[dung.getVector()[i][j].getCreature()->getPosX()][dung.getVector()[i][j].getCreature()->getPosY() - k].getSymbol() == '_'))
										{
											logV.push_back("The Shotgunner shot the wall!");
											k = 7;
										}
										else if (k == 6)
										{
											displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() - k] = 'O';
											logV.push_back("The Shotgunner fires a shot and misses. You're out of range!");
										}
										else
										{
				
										tempSymb = displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() - k];
										displayVector[dung.getVector()[i][j].getCreature()->getPosX() + 1][dung.getVector()[i][j].getCreature()->getPosY() - k] = 'o';
										}
										//Comment for nCurses
										//displaydisplayVector(displayVector);
										//cin.get();
										//Uncomment for nCurses
										updateNcurses(displayVector);
										getch();
										//millisleep(100);
									}
								}
							}
						}
					}

					
					if (dung.randomNumber(4) == 0)
					{
						if(dung.getVector()[i - 1][j].getTraversable() == true)
						{
							dung.getVector()[i - 1][j].setCreature(dung.getVector()[i][j].getCreature());
							dung.getVector()[i - 1][j].getCreature()->setPosX(i - 1);
							dung.getVector()[i][j].setCreature(NULL);
							dung.getVector()[i][j].set_holdsCreature(false);
						}
					}
					else if (dung.randomNumber(4) == 1)
					{
						if(dung.getVector()[i][j - 1].getTraversable() == true)
						{
							dung.getVector()[i][j - 1].setCreature(dung.getVector()[i][j].getCreature());
							dung.getVector()[i][j - 1].getCreature()->setPosY(j - 1);
							dung.getVector()[i][j].setCreature(NULL);
							dung.getVector()[i][j].set_holdsCreature(false);
						}
					}
					else if (dung.randomNumber(4) == 2)
					{
						if(dung.getVector()[i][j + 1].getTraversable() == true)
						{
							dung.getVector()[i][j + 1].setCreature(dung.getVector()[i][j].getCreature());
							dung.getVector()[i][j + 1].getCreature()->setPosY(j + 1);
							dung.getVector()[i][j].setCreature(NULL);
							dung.getVector()[i][j].set_holdsCreature(false);
							if (j != (dung.getVector()[i].size() - 1)) { j++;}								
						}
					}
					else if (dung.randomNumber(4) == 3)
					{
						if(dung.getVector()[i + 1][j].getTraversable() == true)
						{
							dung.getVector()[i + 1][j].setCreature(dung.getVector()[i][j].getCreature());
							dung.getVector()[i + 1][j].getCreature()->setPosX(i + 1);
							dung.getVector()[i][j].setCreature(NULL);
							dung.getVector()[i][j].set_holdsCreature(false);
							if (i != (dung.getVector().size() -1)) { i++;}
						
						}
					}
				}
			}
		}
	}
}

void attackPlayerTurn(Player * pPlayer, Creature * cCreature, DungeonLevel & dung, vector<string> & logV, int & iChain, int & totalKills, stringstream & display, bool & killFlag, bool shottyToggle, bool & bossDead)
{
	ostringstream log;
	int random = dung.randomNumber(10);
	if (shottyToggle == true) {random = 10;}
	logV.push_back(pPlayer->attack(cCreature, random, iChain));
	int i = cCreature->getPosX();
	int j = cCreature->getPosY();
	if (cCreature->getHealth() <= 0)
	{
		iChain++;
		killFlag = true;
		if (shottyToggle == false)
		{
			display.str("");
			display << "   $$$   $$   $$  $   $ $   The " << cCreature->getName() << " goes down!                  " << endl;
			display << "   $  $ $  $ $  $ $$ $$ $   Chain x" << iChain << "             I:~....,,:.....,,,..::~+=??" << endl;
			display << "   $$$  $  $ $  $ $ $ $ $                        ,....:~++~:...,,:,:,,.:,,~?" << endl;
			display << "   $  $ $  $ $  $ $   $   ^                     ...,+++++++~:,::~~=+==~~.::+" << endl;
			display << "   $$$   $$   $$  $   $ $  ?                  =..:=~~===~=======+???????I+,~" << endl;
			display << "                            7     '          ,..=~~~~~:~~~====++????IIIIII7=" << endl;
			display << "        '                    7  .  .        ,..~~~~~:::~::~~==+++???IIII7777" << endl;
			display << "          .                   V     ^       ..::~~:::::,:::~~~==++????I77777" << endl;
			display << "            ^                        ?     ...,::::::::~~~~=====+++???I777,," << endl;
			display << "              ?                       7   ..,.::::::::::~~=++=+++++???II77,," << endl;
			display << "                7       '              7  ..,.::=~~~::,:::~==????+++??7I7777" << endl;
			display << "                  7   .   . ^             .,,.~~::::~~:,,:::~+?===++?I777,77" << endl;
			display << "                    V         ?          +:..,~:,...~::::::::?=~~+=+II777777" << endl;
			display << "                                 7     :~,:.,~,,.........:,,:~~=??+?I7777777" << endl;
			display << "                                    7  ..,,=:::,..,,::,....,:,=7?=?I77777777" << endl;
			display << "+III=:~=?I7I?III++=~77I=IIIIII7II     =.,,=.:,.......,:,....,~77?~,,..+I7777" << endl;
			display << ",,,,:,,::,,~:~~+=::~=:~,=I7?I=~:??7   ~,.~.,:,..,,..........~?777~:::..:==77" << endl;
			display << "=~,,~===~,:~:::==~++?+?+?+====+?I77777,..~,,,:::::~~~::,,::~?I77~..,,:~~++=I" << endl;
			display << "=~=~~~~~:~:~~::~:==+III??I??=??+=?++++?I:,..,,,:,::~~::,:::~?777=....,?7777I" << endl;
			display << "~:~~~~:::~~~~:,:~====++++=?II??7?=?I???I???+++:..,:::...:~??I777I,,,..I7I777" << endl;
			display << ":~:::::~~~=:=::~~=+=~~~~~++III??+I+?IIIII?I???+:.,:,.,.::~+I77777?~~=?I7?777" << endl;
			display << ",,,,,,::~:::::~~=++=~=~=~+???~~++????IIIIIII?III7,..,..,::~+777 7II=+7777777" << endl;
			display << ",,,,,::,,,..,:~~~::~~:~=?????:~~=~=~?II??I+II7777...,...,,~?77777I???7777777" << endl;
			display << ":~:::::,,::~~~~::::=~=~=???+=~~~==+++?I?II=?II777..:=:,..,I7.+777I??II777777" << endl;
			display << ":,,,,:~~,~=~=~::,~~=~:..~~==~,,:~=+=?III7IIII7777.,~,~I+..=77I77?I?I77777777" << endl;
			display << ".,,::,,,,,,,,:,,~+7I77:.,,~,:=~~~+~~++?I++=+77777.,~..:7..~77777II7I7777777I" << endl;
			display << ",,,,,,...,.?77       777..,.,::~~+:?+=~:::~I77777.~+:..,7=+?I77777777777777?" << endl;
			display << ",,......=?              7,,,,,,,:=?+~~~=+~.~+I=77.:I+,,.,I7II777777777..77I=" << endl;
			display << "...,+I7                   7I..,,.......,:....~I7I.,+:...:.:?III7777777.. ~.." << endl;
			display << "::?                           ~...,....,,,,.,+77...,=......,=?7777777.777.,+" << endl;
			display << "                                 .......,~~:~?7I....:I+......:I77777777=..==" << endl;
			display << "                                   ..................:II7I7??~+I777777==++  " << endl;
			display << "                      ~==+?I777I~=+:,,...,,...........,:+I777+~I777777?     " << endl;
			display << "          +=?+?II?I?=I?++=??+?=:??I.,....................:?7?=~I77777~      " << endl;
			display << "     +=~=~=:?=???+?++??+++?I?~:=~+=.,.............,,,:::.,~~::??I777:       " << endl;
			display << "   ====+:=:+=++==?++==++++=++====+~,,.............,,:,=?=~::~?:,II+         " << endl;
			display << " ++=:+=~~~++===++++++~=++=~=+===~=:.,,.............,.,~=+~:==:~=?.777=      " << endl;
			display << "=~~=.:~:~====+++++++=:=++=:~+==~~==...................,,~:~,:::,I777777?    " << endl;
			display << "+~,~.~:~~===+=+===++~~==+=~~+~~~~~~=:~...................,.,,.++I?=?77777=~ " << endl;
		}
		else
		{
			display << "                  .,,,,,,,,..        X  X  XX  XXX   XX   XX  X   X  X X    " << endl;
			display << "               .,,,,,,,,.......      X X  X  X X  X X  X X  X XX XX  X X    " << endl;
			display << "              .,,,,,,,,..,..,,,,     XX   XXXX XXX  X  X X  X X X X  X X    " << endl;
			display << "             .,,,,,,,,,,,,,.,~=~,    X X  X  X X  X X  X X  X X   X         " << endl;
			display << "            .,,,,,:~::,,,,,,:~==:.   X  X X  X XXX   XX   XX  X   X  X X    " << endl;
			display << "            .,::::=I??+~::,:~~~~=.                                          " << endl;
			display << "            .::::~+II??+=~~~~~~~~~.   The " << cCreature->getName() << " got BLASTED! " << endl;
			display << "            .,::~~=?I?++=~~~~~~~~~.         Chain x" << iChain << "          " << endl;
			display << "             .::~~~+??+++=~~~::::,,                                         " << endl;
			display << "              .~~~=III?+~~:::~:,,,:                                         " << endl;
			display << "             .~=+=+III=~,,,.,~~::~~                       ,,                " << endl;
			display << "             .:+:I?III==,,,:~~~~~~~                                         " << endl;
			display << "              .~~=III????+~:+I=~~,~                                    ,    " << endl;
			display << "                .?+II???+=:,++~~~::             ,                           " << endl;
			display << "                  .II???=:,:::::,::                   ,        ,            " << endl;
			display << "                  .,I???~::,,,,,,::                 ..    ,,,,,             " << endl;
			display << "                   .????=~::,::::~:                ,     ,,,,..,            " << endl;
			display << "                   .:I???:~:::,,::::             ,       .......            " << endl;
			display << "                   .:I??+=~===:::::~,          ,,,      ,.....,,            " << endl;
			display << "                   .+7I?+=::~:,,,:.....,.,,,,,,,,,,,,,  ....,,              " << endl;
			display << "                   .~II??+=~:,,...............,...,,.....,,,,               " << endl;
			display << "                 .:::,,,,,,................,,,,,..,.....,,..,.              " << endl;
			display << "               .:::::,,,,...............,,.~,,,,......,,....,....          :" << endl;
			display << "              .,:::,,,...,,,,,..,,,,,,,,,:777,,,.....,,,......,=IIIIII777777" << endl;
			display << "             .:,,,,,,,,,,,,,,,,,,,,...,.,.I~,,,,....,.......,,77777777I77777" << endl;
			display << "            .:,,,,,,,,,:::,,............,,,,..,....,,.......,?7777777=7I7777" << endl;
			display << "          .,,,,,,,::::,,.....,,,...,,:,.=,,,,...,,:,,.......:I77777:,,777777" << endl;
			display << "         .::,,,,,,:::..,,,,,,,,,,.,,:77,,,.,,,,,=+,,.......,:,,.:,,.=7777777" << endl;
			display << "        .:,,,,,,,:::..,,,,,,,,,,.,,+77~....,.,.777,,......,,,.,,~???IIIIIIII" << endl;
			display << "       .,:,,,,,,:,::..,,,,,,,,,,..,,~,,......,,,~,,......,,,,,,,:,,:::,:=??+" << endl;
			display << "       .::,,,..,,,,,..,,,,,,,,,.........................,                   " << endl;
			display << "      .,::..:,,,.,,,...,:,,,,............................                   " << endl;
			display << "      .:::..,,,,,..,...,,.,,,,..................,,.,,....                   " << endl;
			display << "      .::::,..,,......,,.,,,,,.................,=,I,,.....                  " << endl;
			display << "      .:::::,...,...,.,..,,,:,....,,..........,+7I:,.......                 "<< endl;
			display << "      .::::,,,..........,,,:,,,,,,,,...........,,,,.........                " << endl;
			display << "      .:::::,,,.........,,,,,,,,,,,,........................=               " << endl;
			display << "      .:::::,,..............,,,,,,,,,........................?~             " << endl;
			display << "     ..:::::,,......I.......,,,,,,,,,,........................?=            " << endl;
			/*
			display << "......~,::~+I?=~,..~~+......,,,,,,,,,,,.......................,~~,:~?I.,,.:~" << endl;
			display << "...~...~~7777I+=~:.:=+::.....,,,,,,,,,,,,,.....................=:,:~~I:....:" << endl;
			display << ",:~:+?,,7777I?+=~:,:~~??.....,,,,,,,,,,,,,,,....................?:,:~:?:...:" << endl;
			display << ":,,~~=+.7777I?+=~:+.::~?:......,,,,,,,,,,,,..,,..................?..~::?:..." << endl;
			display << ":I.,:::.7777I?+=~~~?,:~:.......,,,,,,,,,,,,,,.....................:,,:::?..." << endl;
			display << "~:?::~~:77I??++==~~:~:~~~?:....,,,,,,.,,,,,,,,,..................,.?.,:::?,=" << endl;
			display << "~:~:,::~7I?+=++==~::~,,~:~I....,,,,,,,,..,,,,,,,...................,?.:~~:::" << endl;
			display << ".:~~?.,7II++==++=~:~~?=.:~~+...,,,,,,,,,..,,,,,,..................,.:+.,~:.." << endl;
			display << ".,:~=+I7I?++=====~.::~?.~:~:....,,,,,,,,,...,,,,....................~+      " << endl;
			display << "..,~~~77II+======~..::~~~,......,,,,.,,,,,,........................:,       " << endl;
			display << "...,~=77II?+====~~...:...........,,,.,.,,,.......................,~:,       " << endl;
			display << ".....~7III?++===~~................,,,...........................,:~::       " << endl;
			display << ".....:7III??====~:...........~,,,~~:,,,.......................,~,~~~~,      " << endl;
			display << ".....:77II?+===~~,...........?,:::,,::,::~+=:............,~~~,,,..~:::.     " << endl;
			display << ".....:77II+====~~,..........,~:~:::::~:::,,::,..?:,:::,,,.,::,,,,.:,:::,    " << endl;
			display << ".....:77II====~~~...........,::~:~~~~::,:,,:::,:+~,,,,,,,,,:~,,,,.:,,~~~.   " << endl;
			display << "......I7I?===~~~:...........,~~::::,,,,,::::,,,,::.,,,,,,,,,:,,,,,,::,~,...." << endl;
			display << "......::::,,,,,,.............:.....................................,...,...." << endl;
			*/
			}
				
		if (cCreature->getName() == "Mister X")
		{
			bossDead = true;
			log << "You killed " << cCreature->getName() << " and gained " << (5 * dung.getFloor()) + 1000 << " Exp.";
			logV.push_back(log.str());
			log.str("");
			log.clear();
			//log << "All of Mister X's remaining goons get scared and run away.";
			//logV.push_back(log.str());
			//log.str("");
			//log.clear();
			log << "A pathway opens up... You can finally save her!";
			logV.push_back(log.str());
			log.str("");
			log.clear();
			for (int i = 0; i < dung.getVector().size(); i++)
			{
				for (int j = 0; j < dung.getVector().size(); j++)
				{
					if(dung.getVector()[i][j].get_holdsCreature() == true)
					{
						//if (!(dung.getVector()[i][j].getCreature()->getName() == "Mister X"))
						//{
						//cout << " Deleting " << dung.getVector()[i][j].getCreature()->getName() << endl;
							dung.getVector()[i][j].setCreature(NULL);
							dung.getVector()[i][j].set_holdsCreature(false);
						//}
					}
				}
			}
			
			dung.getVector()[7][37].useTemplate(6);
			dung.getVector()[7][37].revealHidden();
			dung.getVector()[7][38].useTemplate(1);
			dung.getVector()[7][38].revealHidden();
			dung.getVector()[7][39].useTemplate(8);
			dung.getVector()[7][39].revealHidden();
		}
		else if(shottyToggle == true)
		{
			log << "The " << cCreature->getName() << " got kaboomed! You gained " << (5 * dung.getFloor()) << " Exp.";
			logV.push_back(log.str());
		}
		else
		{
			log << "You killed the " << cCreature->getName() << " and gained " << (5 * dung.getFloor()) << " Exp.";
			logV.push_back(log.str());
		}
		log.str("");
		log.clear();
		dung.setnumEnemies(dung.getnumEnemies() - 1);
		cout << dung.getnumEnemies();
		totalKills++;
		int dropItem = dung.randomNumber(6);
		
		pPlayer->setExperience(pPlayer->getExperience() + (5 * dung.getFloor()));
		if ((dung.getFloor() == 4)&&(dung.getnumEnemies() == 0))
		{
			//cout << "revealing tiles" << endl;
			dung.getVector()[7][37].useTemplate(6);
			dung.getVector()[7][37].revealHidden();
			dung.getVector()[7][38].useTemplate(1);
			dung.getVector()[7][38].revealHidden();
			dung.getVector()[7][39].useTemplate(8);
			dung.getVector()[7][39].revealHidden();
		}
		else if (dung.getnumEnemies() == 0)
		{
			Consumable * pConsumable = GenericFactory::instance().generateKeyConsumable(0);
			
				dung.getVector()[i][j].setConsumables(pConsumable);
				dung.getVector()[i][j].getConsumableVec().back()->setPosX(i);
				dung.getVector()[i][j].getConsumableVec().back()->setPosY(j);
				logV.push_back("The " + cCreature->getName() + " dropped " + pConsumable->getName());
		}
		else if (cCreature->getName() == "Drunk Punk")
		{
			Consumable * pConsumable = GenericFactory::instance().generateKeyConsumable(1);
			
				dung.getVector()[i][j].setConsumables(pConsumable);
				dung.getVector()[i][j].getConsumableVec().back()->setPosX(i);
				dung.getVector()[i][j].getConsumableVec().back()->setPosY(j);
				logV.push_back("The " + cCreature->getName() + " dropped " + pConsumable->getName());
		}
		else if (cCreature->getName() == "Shotgunner")
		{
			Consumable * pConsumable = GenericFactory::instance().generateKeyConsumable(2);
			pConsumable->setQuantity(8);			
				dung.getVector()[i][j].setConsumables(pConsumable);
				dung.getVector()[i][j].getConsumableVec().back()->setPosX(i);
				dung.getVector()[i][j].getConsumableVec().back()->setPosY(j);
				logV.push_back("The " + cCreature->getName() + " dropped " + pConsumable->getName() + " x4");
		}
		else if(dropItem == 0)
		{
			Armor * pArmor = GenericFactory::instance().generateArmor();
			pArmor->setDefenseBonus((pArmor->getDefenseBonus() + dung.getFloor()) + pPlayer->getLevel());
			pArmor->setValue((pArmor->getValue() * dung.getFloor()) + (5 * pPlayer->getLevel()));
			dung.getVector()[i][j].setArmors(pArmor);
			dung.getVector()[i][j].getArmorVec().back()->setPosX(i);
			dung.getVector()[i][j].getArmorVec().back()->setPosY(j);
			logV.push_back("The " + cCreature->getName() + " dropped the " + pArmor->getName());
		}
		else if(dropItem == 1)
		{
			Weapon * pWeapon = GenericFactory::instance().generateWeapon();
			if (pWeapon->getWeaponType() == 3)
			{
				delete pWeapon;
			}
			else
			{
				pWeapon->setAttackBonus((pWeapon->getAttackBonus() * dung.getFloor()) + pPlayer->getLevel());
				pWeapon->setValue((pWeapon->getValue() * dung.getFloor()) + (5 * pPlayer->getLevel()));
				dung.getVector()[i][j].setWeapons(pWeapon);
				dung.getVector()[i][j].getWeaponVec().back()->setPosX(i);
				dung.getVector()[i][j].getWeaponVec().back()->setPosY(j);
				logV.push_back("The " + cCreature->getName() + " dropped the " + pWeapon->getName());
			}
		}
		else if (dropItem > 3)
		{
			Consumable * pConsumable = GenericFactory::instance().generateNotKeyConsumable(0);
			
				dung.getVector()[i][j].setConsumables(pConsumable);
				dung.getVector()[i][j].getConsumableVec().back()->setPosX(i);
				dung.getVector()[i][j].getConsumableVec().back()->setPosY(j);
				logV.push_back("The " + cCreature->getName() + " dropped " + pConsumable->getName());
			
		}
		delete cCreature;
		dung.getVector()[i][j].set_holdsCreature(false);
	}
}
void detonateBombs(DungeonLevel & dung, int x, int y, Player * pPlayer, vector<string> & logV, int & iChain, int & totalKills, stringstream & display, bool & killFlag, bool & bossDead)
{
	bool bombToggle = true;
	dung.getVector()[x][y].set_holdsBomb(false);
	for (int p = (x - 2); p < (x + 3); p++)
	{
		for (int q = (y - 2); q < (y + 3); q++)
		{
			if (dung.getVector()[p][q].get_holdsBomb() == true)
			{
				detonateBombs(dung, p, q, pPlayer, logV, iChain, totalKills, display, killFlag, bossDead);
			}
			else
			{
				dung.getVector()[p][q].set_holdsBombRadius(false);
				if (dung.getVector()[p][q].get_holdsCreature() == true)
				{
					attackPlayerTurn(pPlayer, dung.getVector()[p][q].getCreature(), dung, logV, iChain, totalKills, display, killFlag, bombToggle, bossDead);
				}
				else if (dung.getVector()[p][q].get_holdsPlayer() == true)
				{
					pPlayer->setHealth(pPlayer->getHealth() - 100);
					if (pPlayer-> getHealth() < 0) {pPlayer->setHealth(0);}
					logV.push_back("A bomb exploded and you took 100 damage!");
				}
				else if ((p == (x + 2))&&(q == (y + 2)))
				{
					logV.push_back(" A bomb exploded!");
				}
			}
		}
	}
}
void checkBombs(DungeonLevel & dung, Player * pPlayer, vector<string> & logV, int & iChain, int & totalKills, stringstream & display, bool & killFlag, bool & bossDead)
{
	for (int i = 0; i < dung.getVector().size(); i++)
	{
		for (int j = 0; j < dung.getVector()[i].size(); j++)
		{
			if (dung.getVector()[i][j].get_holdsBomb() == true)
			{
				dung.getVector()[i][j].set_bombCounter(dung.getVector()[i][j].get_bombCounter() - 1);
				for (int p = (i - 2); p < (i + 3); p++)
				{
					for (int q = (j - 2); q < (j + 3); q++)
					{
						dung.getVector()[p][q].set_holdsBombRadius(true);
					}
				}
				if (dung.getVector()[i][j].get_bombCounter() == 0)
				{
					detonateBombs(dung, i, j, pPlayer, logV, iChain, totalKills, display, killFlag, bossDead);
				}
			}
		}
	}
}

void shootShotty( char pInput, Player * p1, DungeonLevel & dung, vector<string> & logV, int & iChain, int & totalKills, stringstream & display, bool & killFlag, vector<vector<char>> & displayVector, bool shottyToggle, bool & bossDead)
{
	char tempSymb;
	if (pInput == '8')
	{
		for (int i = 1; i < 9; i++)
		{
			if (i != 1)
			{
				displayVector[p1->getPosX() - i + 2][p1->getPosY()] = tempSymb;
			}
			if ((p1->getPosX() - i) == 0)
			{
				logV.push_back("You Missed!");
				i = 9;
			}
			else if (dung.getVector()[p1->getPosX() - i][p1->getPosY()].get_holdsCreature() == true)
			{
				attackPlayerTurn(p1, dung.getVector()[p1->getPosX() - i][p1->getPosY()].getCreature(), dung, logV, iChain, totalKills, display, killFlag, shottyToggle, bossDead);
				displayVector[p1->getPosX() - i + 1][p1->getPosY()] = 'O';
				i = 9;
			}
			else if ((dung.getVector()[p1->getPosX() - i][p1->getPosY()].getSymbol() == '|')||(dung.getVector()[p1->getPosX() - i][p1->getPosY()].getSymbol() == '_'))
			{
				logV.push_back("You shot the wall!");
				i = 9;
			}
			else if ( i == 8)
			{
				displayVector[p1->getPosX() - i + 1][p1->getPosY()] = 'O';
				logV.push_back("You didn't hit anything! Shotty range is 8 tiles.");
			}
			else
			{
				
				tempSymb = displayVector[p1->getPosX() - i + 1][p1->getPosY()];
				displayVector[p1->getPosX() - i + 1][p1->getPosY()] = 'o';
			}
			//Comment for nCurses
			//displaydisplayVector(displayVector);
			//cin.get();
			//Uncomment for nCurses
			updateNcurses(displayVector);
			getch();
			//millisleep(100);
		}
	}
	if (pInput == '2')
	{
		for (int i = 1; i < 9; i++)
		{
			if (i != 1)
			{
				displayVector[p1->getPosX() + i][p1->getPosY()] = tempSymb;
			}
			if ((p1->getPosX() + i) == 19)
			{
				logV.push_back("You Missed!");
				i = 9;
			}
			else if (dung.getVector()[p1->getPosX() + i][p1->getPosY()].get_holdsCreature() == true)
			{
				attackPlayerTurn(p1, dung.getVector()[p1->getPosX() + i][p1->getPosY()].getCreature(), dung, logV, iChain, totalKills, display, killFlag, shottyToggle, bossDead);
				displayVector[p1->getPosX() + i + 1][p1->getPosY()] = 'O';
				i = 9;
			}
			else if ((dung.getVector()[p1->getPosX() + i][p1->getPosY()].getSymbol() == '|')||(dung.getVector()[p1->getPosX() + i][p1->getPosY()].getSymbol() == '_'))
			{
				logV.push_back("You shot the wall!");
				i = 9;
			}
			else if ( i == 8)
			{
				displayVector[p1->getPosX() + i + 1][p1->getPosY()] = 'O';
				logV.push_back("You didn't hit anything! Shotty range is 8 tiles.");
			}
			else
			{
				
				tempSymb = displayVector[p1->getPosX() + i + 1][p1->getPosY()];
				displayVector[p1->getPosX() + i + 1][p1->getPosY()] = 'o';
			}
			//Comment for nCurses
			//displaydisplayVector(displayVector);
			//cin.get();
			//Uncomment for nCurses
			updateNcurses(displayVector);
			getch();
			//millisleep(100);
		}
	}
	if (pInput == '4')
	{
		for (int i = 1; i < 9; i++)
		{
			if (i != 1)
			{
				displayVector[p1->getPosX() + 1][p1->getPosY() - i + 1] = tempSymb;
			}
			if ((p1->getPosY() - i) == 0)
			{
				logV.push_back("You Missed!");
				i = 9;
			}
			else if (dung.getVector()[p1->getPosX()][p1->getPosY() - i].get_holdsCreature() == true)
			{
				attackPlayerTurn(p1, dung.getVector()[p1->getPosX()][p1->getPosY() - i].getCreature(), dung, logV, iChain, totalKills, display, killFlag, shottyToggle, bossDead);
				displayVector[p1->getPosX() + 1][p1->getPosY() - i] = 'O';
				i = 9;
			}
			else if ((dung.getVector()[p1->getPosX()][p1->getPosY() - i].getSymbol() == '|')||(dung.getVector()[p1->getPosX()][p1->getPosY() - i].getSymbol() == '_'))
			{
				logV.push_back("You shot the wall!");
				i = 9;
			}
			else if ( i == 8)
			{
				displayVector[p1->getPosX() + 1][p1->getPosY() - i] = 'O';
				logV.push_back("You didn't hit anything! Shotty range is 8 tiles.");
			}
			else
			{

				tempSymb = displayVector[p1->getPosX() + 1][p1->getPosY() - i];
				displayVector[p1->getPosX() + 1][p1->getPosY() - i] = 'o';
			}
			//Comment for nCurses
			//displaydisplayVector(displayVector);
			//cin.get();
			//Uncomment for nCurses
			updateNcurses(displayVector);
			getch();
			//millisleep(100);
		}
	}
	if (pInput == '6')
	{
		for (int i = 1; i < 9; i++)
		{
			if (i != 1)
			{
				displayVector[p1->getPosX() + 1][p1->getPosY() + i - 1] = tempSymb;
			}
			if ((p1->getPosY() + i) == 71)
			{
				logV.push_back("You Missed!");
				i = 9;
			}
			else if (dung.getVector()[p1->getPosX()][p1->getPosY() + i].get_holdsCreature() == true)
			{

				attackPlayerTurn(p1, dung.getVector()[p1->getPosX()][p1->getPosY() + i].getCreature(), dung, logV, iChain, totalKills, display, killFlag, shottyToggle, bossDead);
				displayVector[p1->getPosX() + 1][p1->getPosY() + i] = 'O';
				i = 9;
			}
			else if ((dung.getVector()[p1->getPosX()][p1->getPosY() + i].getSymbol() == '|')||(dung.getVector()[p1->getPosX()][p1->getPosY() + i].getSymbol() == '_'))
			{
				logV.push_back("You shot the wall!");
				i = 9;
			}
			else if ( i == 8)
			{
				displayVector[p1->getPosX() + 1][p1->getPosY() + i] = 'O';
				logV.push_back("You didn't hit anything! Shotty range is 8 tiles.");
			}
			else
			{

				tempSymb = displayVector[p1->getPosX() + 1][p1->getPosY() + i];
				displayVector[p1->getPosX() + 1][p1->getPosY() + i] = 'o';
			}
			//Comment for nCurses
			//displaydisplayVector(displayVector);
			//cin.get();
			//Uncomment for nCurses
			updateNcurses(displayVector);
			getch();
			//millisleep(100);
		}

	}
}

				



void changeFloor(int x, int y, DungeonLevel & dung, int & iCurFloor, vector<Consumable*> cVec)
{
	if (dung.getVector()[x][y].getSymbol() == '>')
	{
		iCurFloor++;
	}
	if ((dung.getVector()[x][y].getSymbol() == '<')&&(iCurFloor != 0))
	{
		iCurFloor--;
	}
}

void revealTiles(int x, int y, DungeonLevel & dung, vector<string> & logV)
{
	ostringstream log;
	int i = x;
	int j = y;
	for (int p = x - 1; p <= x + 1; p++)
	{
		for (int q = y - 1; q <= y + 1; q++)
		{
			dung.getVector()[p][q].revealHidden();
			log.str("");
			log.clear();
			if (dung.getVector()[p][q].get_holdsCreature() == true)
			{
				if (dung.getVector()[p][q].getCreature()->getName() == "Drunk Punk")
				{
					int random = dung.randomNumber(2);
					if (random == 0)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": Don't hit me, man. I'm just tryin to party.";
						logV.push_back(log.str());
					}
					else if (random == 1)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": I'd kick your ass if I wasn't seein' double...";
						logV.push_back(log.str());
					}
				}
				else
				{
					int random = dung.randomNumber(8);
					if (random == 0)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": I'm gonna get you, sucka!";
						logV.push_back(log.str());
					}
					else if (random == 1)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": I love making hipsters cry!... Is that a tear in your eye?";
						logV.push_back(log.str());
					}
					else if (random == 2)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": I'm gonna make you squeal just like your girlfriend did!";
						logV.push_back(log.str());
					}
					else if (random == 3)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": Hey tough-guy, you think you're man enough?";
						logV.push_back(log.str());
					}
					else if (random == 4)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": I been hittin the gym... hard! Now I'm gonna hit you.";
						logV.push_back(log.str());
					}
					else if (random == 5)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": Hey pretty boy! Say goodbye to your face!";
						logV.push_back(log.str());
					}
					else if (random == 6)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": Hey punk! You ready for an ass kicking?";
						logV.push_back(log.str());
					}
					else if (random == 7)
					{
						log << "[" << dung.getVector()[p][q].getCreature()->getSymbol() << "]" << dung.getVector()[p][q].getCreature()->getName() << ": I'll apologize to your mom when I see her at your funeral!";
						logV.push_back(log.str());
					}
				}
			}
		}
	}
	
	if( dung.getVector()[x][y].getSymbol() == '.')
	{
		while (!((dung.getVector()[i][y].getSymbol() == ' ')||(i == 0)||(dung.getVector()[i][y].getSymbol() == '#')))
		{
			i -= 1;
			dung.getVector()[i][j].revealHidden();
		}
		i++;
		j = y;
		while (!((dung.getVector()[i+1][j].getSymbol() == ' ')||(j == 0)||(dung.getVector()[i][j].getSymbol() == '#')))
		{
			j -= 1;
			dung.getVector()[i][j].revealHidden();
		}
		j++;
		int k = j;
		while (!((dung.getVector()[i][j].getSymbol() == ' ')||(dung.getVector()[i][j].getSymbol() == '#')))
		{
			while (!((dung.getVector()[i][j].getSymbol() == ' ')||(dung.getVector()[i][j].getSymbol() == '#')))
			{
				dung.getVector()[i][j].revealHidden();
				j++;
			}
			j = k;
			i++;
		}
	}
}

bool getPassable(int x, int y, DungeonLevel dung)
{
	if (dung.getVector()[x][y].getTraversable() == false)
	{
		return false;
	}
	else
		return true;
}


void move(char cInput, Player * p1, DungeonLevel & dung, int & iCurFloor, vector<string> & logV, int & iChain, int & totalKills, stringstream & display, bool & killFlag, bool shottyToggle, bool & bossDead)
{
	if (cInput)
	{
		if (cInput == '8')
		{
			if(getPassable(p1->getPosX() - 1, p1->getPosY(), dung) == true)
			{
				dung.getVector()[p1->getPosX()][p1->getPosY()].setPlayer(NULL);
				dung.getVector()[p1->getPosX()][p1->getPosY()].set_holdsPlayer(false);			
				p1->setPosX(p1->getPosX() - 1);
				dung.getVector()[p1->getPosX()][p1->getPosY()].setPlayer(p1);
				revealTiles(p1->getPosX(), p1->getPosY(), dung, logV);
			}
			if(dung.getVector()[p1->getPosX() - 1][p1->getPosY()].get_holdsCreature()==true)
			{
				attackPlayerTurn(p1,dung.getVector()[p1->getPosX() - 1][p1->getPosY()].getCreature(), dung, logV, iChain, totalKills, display, killFlag, shottyToggle, bossDead);
			}
		}
		else if (cInput == '2')
		{
			if (getPassable(p1->getPosX() + 1, p1->getPosY(), dung) == true)
			{
				dung.getVector()[p1->getPosX()][p1->getPosY()].setPlayer(NULL);
				dung.getVector()[p1->getPosX()][p1->getPosY()].set_holdsPlayer(false);			
				p1->setPosX(p1->getPosX() + 1);
				dung.getVector()[p1->getPosX()][p1->getPosY()].setPlayer(p1);
				revealTiles(p1->getPosX(), p1->getPosY(), dung, logV);
			}
			if(dung.getVector()[p1->getPosX() + 1][p1->getPosY()].get_holdsCreature()==true)
			{
				attackPlayerTurn(p1,dung.getVector()[p1->getPosX() + 1][p1->getPosY()].getCreature(), dung, logV, iChain, totalKills, display, killFlag, shottyToggle, bossDead);
			}
		}
		else if (cInput == '4')
		{
			if (getPassable(p1->getPosX(), p1->getPosY() - 1, dung) == true)
			{
				dung.getVector()[p1->getPosX()][p1->getPosY()].setPlayer(NULL);
				dung.getVector()[p1->getPosX()][p1->getPosY()].set_holdsPlayer(false);			
				p1->setPosY(p1->getPosY() - 1);
				dung.getVector()[p1->getPosX()][p1->getPosY()].setPlayer(p1);
				revealTiles(p1->getPosX(), p1->getPosY(), dung, logV);
			}
			if(dung.getVector()[p1->getPosX()][p1->getPosY() - 1].get_holdsCreature()==true)
			{
				attackPlayerTurn(p1,dung.getVector()[p1->getPosX()][p1->getPosY() - 1].getCreature(), dung, logV, iChain, totalKills, display, killFlag, shottyToggle, bossDead);
			}
		}
		else if (cInput == '6')
		{
			if (getPassable(p1->getPosX(), p1->getPosY() + 1, dung) == true)
			{
				dung.getVector()[p1->getPosX()][p1->getPosY()].setPlayer(NULL);
				dung.getVector()[p1->getPosX()][p1->getPosY()].set_holdsPlayer(false);			
				p1->setPosY(p1->getPosY() + 1);
				dung.getVector()[p1->getPosX()][p1->getPosY()].setPlayer(p1);
				revealTiles(p1->getPosX(), p1->getPosY(), dung, logV);
			}
			if(dung.getVector()[p1->getPosX()][p1->getPosY() + 1].get_holdsCreature()==true)
			{
				attackPlayerTurn(p1,dung.getVector()[p1->getPosX()][p1->getPosY() + 1].getCreature(), dung, logV, iChain, totalKills, display, killFlag, shottyToggle, bossDead);
			}
		}

		return;
		
	}
	else
		return;
}


int main(int argc, char * argv[])
{
	int num = 0;
	int cVecIt = 0;
	int aVecIt = 0;
	int wVecIt = 0;
	vector<Consumable*> cVec(4);
	vector<Armor*> aVec;
	vector<Weapon*> wVec;
	Player * p1 = GenericFactory::instance().generatePlayer();
	vector<string> logV;
	vector<vector<char>> displayVector (40);
	for(int i = 0; i < displayVector.size(); i++)
			displayVector[i].resize(80,' ');
	stringstream display;
	
	
	
	logV.push_back("Basic Controls: [8]:Up [2]:Down [4]:Left [6]:Right [5]:Pick-up/use stairs");
	logV.push_back("Get to the 8th floor and you should find her!                   ");
	logV.push_back("Beat up punks and find the key to move on to the next floor.    ");
	logV.push_back("Are you a Tough enough dude to rescue your girlfriend?");
	
	while (num < 1)
	{
		Weapon * w1 = GenericFactory::instance().generateWeapon();
		if (w1->getWeaponType() == 1)
		{
			p1->setWeaponSlot(w1);
			wVec.push_back(w1);
			num += 1;
		}
		else if (num != 1)
			delete w1;
	}
	num = 0;
	while (num < 1)
	{
		Armor * a1 = GenericFactory::instance().generateArmor();
		if (a1->getDefenseBonus() == 1)
		{
			p1->setArmorSlot(a1);
			aVec.push_back(a1);
			num += 1;
		}
		else if(num != 1)
			delete a1;
	}
	num = 0;
	bool gotKeys = false;
	bool gotSauce = false;
	bool gotShells = false;
	bool gotEnergy = false;
	while(gotSauce == false)
	{
		Consumable * c1 = GenericFactory::instance().generateConsumable();
		c1->setQuantity(2);
		if (c1->getWeight() == 1)
		{
			cVec[0] = c1;
			gotSauce = true;
		}
		else 
			delete c1;
	}
	while(gotShells == false)
	{
		Consumable * c2 = GenericFactory::instance().generateConsumable();
		c2->setQuantity(10);
		if (c2->getWeight() == 2)
		{
			cVec[1] = c2;
			gotShells = true;
		}
		else
			delete c2;
	}
	while(gotKeys == false)
	{
		Consumable * c3 = GenericFactory::instance().generateConsumable();
		c3->setQuantity(0);
		if (c3->getWeight() == 0)
		{
			cVec[2] = c3;
			gotKeys = true;
		}
		else
			delete c3;
	}
	while(gotEnergy == false)
	{
		Consumable * c4 = GenericFactory::instance().generateConsumable();
		c4->setQuantity(1);
		if (c4->getWeight() == 3)
		{
			cVec[3] = c4;
			gotEnergy = true;
		}
		else
			delete c4;
	}
	int icurSel = 2;
	int icurCon = 0; 
	int icurScore = 0;
	
                                                                                    
																					 
	DungeonLevel dung;
	vector<DungeonLevel> dLevels;
	int curFloor = 0;
	
	for (int i = 0; i < 9; i++)
	{
		dung.generateLevel();
		
		if (i == 3)
		{
			Weapon * wS = GenericFactory::instance().generateSpecificWeapon(3);
			Consumable * cK = GenericFactory::instance().generateKeyConsumable(0);
			specialLevel(dung);
			dung.setxIn(17);
			dung.setyIn(38);
			dung.setxOut(3);
			dung.setyOut(69);
			dung.getVector()[4][38].setWeapons(wS);
			dung.getVector()[4][38].set_holdsWeapons(true);
			dung.getVector()[4][38].setConsumables(cK);
			dung.getVector()[4][38].set_holdsConsumables(true);
			dung.setFloor(i + 1);
			dLevels.push_back(dung);
		}
		
		if (i == 7)
		{
			Creature * cX = GenericFactory::instance().generateBigCreature(10000);
			Consumable * cBK = GenericFactory::instance().generateKeyConsumable(0);
			specialLevel(dung);
			dung.setxIn(17);
			dung.setyIn(38);
			dung.setxOut(3);
			dung.setyOut(69);
			dung.getVector()[4][38].setCreature(cX);
			dung.getVector()[4][38].set_holdsCreature(true);
			dung.getVector()[4][38].getCreature()->setPosX(4);
			dung.getVector()[4][38].getCreature()->setPosY(38);
			dung.getVector()[4][38].setConsumables(cBK);
			dung.getVector()[4][38].set_holdsConsumables(true);
			dung.setFloor(i + 1);
			dLevels.push_back(dung);
		}
		else if (dung.dTest() == true)
		{
			dung.setFloor(i + 1);
			dLevels.push_back(dung);
		}
	}

	dLevels[curFloor].setStart(p1);
	dLevels[curFloor].spawnEntities();
	
	
	char pInput = '1';
	int baseFloor = curFloor;
	int maxHealth = p1->getHealth();
	int curLev = p1->getLevel();
	int curChain = 0;
	int oldChain  = 0;
	int turnsSinceChain = 0;
	int chainTurns = 5;
	int logSize = 4;
	int maxChain = 0;
	int totalKills = 0;
	string inv;
	int progress = 0;
	string myName = "Tyler";
	string gfName = "Ana";
	char mystr[8];
	char gfstr[8];
	bool killFlag = false;
	bool shottyToggle = false;
	int bossCounter = 0;
	bool bossDead = false;
	//Un-Comment for ncurses:
	initscr();
	//keypad(stdscr, TRUE);
	
	
	while (pInput != 'q')
	{
		if(progress < 10)
		{
			storyBoards(display, displayVector, myName, gfName, progress);
			//Comment for ncurses:
			//displaydisplayVector(displayVector);
			//Un-Comment for ncurses:
			updateNcurses(displayVector);
			
			if (progress == 1)
			{
				//Comment for ncurses:
				//getline(cin, myName);
				//Un-Comment for ncurses:
				getstr(mystr);
				myName = mystr;
				if (myName.size() > 8){	myName.resize(8);}
				p1->setName(myName);
				if (p1->getName() == "GOTOBOSS")
				{
					curFloor = 7;
					Weapon * w2 = GenericFactory::instance().generateSpecificWeapon(3);
					p1->setWeaponSlot(w2);
					wVec.push_back(w2);
					p1->setHealth(250);
					maxHealth = 250;
					p1->setLevel(9);
					p1->setExperience(10000);
					cVec[1]->setQuantity(50);
					cVec[0]->setQuantity(50);
					cVec[3]->setQuantity(10);
					chainTurns = 10;
				}
				
			}
			else if(progress == 2)
			{
				//Comment for ncurses:
				//getline(cin, gfName);
				//Un-Comment for ncurses:
				getstr(gfstr);
				gfName = gfstr;
				if (gfName.size() > 8){ gfName.resize(8);}
			}
			else
			{
			//Comment for ncurses:
			//cin.get();
			//Un-Comment for ncurses
			getch();
			}
		}
		else
		{
			display << noskipws;

			levelUp(p1, maxHealth, logV, chainTurns);
			if (p1->getLevel() > curLev)
			{
				curLev = p1->getLevel();
				maxHealth = p1->getHealth();
			}
			inv = manageInventory(pInput, icurSel, icurCon, icurScore, p1, wVec, aVec, cVec, logV, dLevels[curFloor], curFloor, curChain, gfName, shottyToggle, maxHealth);
			display << "Floor: " << curFloor + 1 << " || " << p1->getName() << " | Health: " << p1->getHealth() << "/" << maxHealth << " | Cash: $" << icurScore << " | Exp: " << p1->getExperience() << " | Level: " << p1->getLevel() << endl;
			display << dLevels[curFloor].displayLevel();
			if (!(curChain > 0))
			{
				display << "Chain x" << curChain << " |||Newest Message On Top|||  KILL PUNKS TO START CHAIN FOR HIGH DMG" << endl;
			}
			else 
			{
				display << "Chain x" << curChain << " |||Newest Message On Top|||  KILL PUNKS OR LOSE CHAIN IN: " << (chainTurns - turnsSinceChain) << " turns" << endl;
			}
		
			displayLog(logV, logSize, display);
			display << inv << endl;			
			updateDisplay(display, displayVector);
			//Comment for ncurses:
			//displaydisplayVector(displayVector);
			//pInput = cin.get();
			//cin.ignore();
			//Un-Comment for ncurses:
			updateNcurses(displayVector);
			pInput = getch();
			/*
 				if (pInput == KEY_DOWN)
                {
                       pInput = '2';
                }
                else if(pInput == KEY_UP)
                {
                       pInput = '8';
                }
                else if(pInput == KEY_LEFT)
                {
                        pInput = '4';
                }
                else if(pInput == KEY_RIGHT)
                {
                        pInput = '6';
                }
				else if(pInput == KEY_ENTER)
				{
						pInput = '5';
				}
				*/
				if(pInput == 'a')
				{
						pInput = '7';
				}
				else if(pInput == 'd')
				{
						pInput = '9';
				}
				else if(pInput == 's')
				{
					pInput = '0';
				}

			if((pInput == '8')||(pInput == '4')||(pInput == '2')||(pInput == '6'))
			{
				if(dLevels[curFloor].getFloor() == 8)
				{
					if (bossDead == false)
					{
						checkBombs(dLevels[curFloor], p1, logV, curChain, totalKills, display, killFlag, bossDead);
					
						if (bossCounter == 0)
						{
							logV.push_back("Mister X [X]: You'll never save " + gfName + "! Get ready to die, Tough-Guy!");
							bossCounter++;
						}					
						else if((bossCounter % 2) == 0)
						{
							logV.push_back("Mister X [X]: Have a blast, sucker! (He tosses some dirty-bombs your way)");						
							placeBomb(dLevels[curFloor]);
							placeBomb(dLevels[curFloor]);
						}
						if((bossCounter % 20) == 0)
						{
						
							logV.push_back("Mister X calls for backup!");
							logV.push_back("Mister X [X]: Let's make this a party!");						
							dLevels[curFloor].spawnEntities();
						}
						if(bossCounter < 22)
						{
							bossCounter++;
						}
						else if(bossCounter == 21)
						{
							bossCounter = 1;
						}
					}
					else
					{
						checkBombs(dLevels[curFloor], p1, logV, curChain, totalKills, display, killFlag, bossDead);
						checkBombs(dLevels[curFloor], p1, logV, curChain, totalKills, display, killFlag, bossDead);
						checkBombs(dLevels[curFloor], p1, logV, curChain, totalKills, display, killFlag, bossDead);
					}
				}



				if (shottyToggle == true)
				{
					shootShotty(pInput, p1, dLevels[curFloor], logV, curChain, totalKills, display, killFlag, displayVector, shottyToggle, bossDead);
					shottyToggle = false;
				}
				else
				{
					move(pInput, p1, dLevels[curFloor], curFloor, logV, curChain, totalKills, display, killFlag, shottyToggle, bossDead);
				}
				if (killFlag == true)
				{
					updateDisplay(display, displayVector);
					//Comment for ncurses:
					//displaydisplayVector(displayVector);
					//cin.get();
					//cin.get();
					//Un-Comment for ncurses:
					updateNcurses(displayVector);
					getch();
					
					killFlag = false;
				}
				moveCreatures(p1,dLevels[curFloor], logV, displayVector);
				if (curChain == oldChain){turnsSinceChain++;}
				else {oldChain = curChain; turnsSinceChain = 0;}
				if (turnsSinceChain == chainTurns)
				{
					if (curChain > maxChain) { maxChain = curChain;}
					curChain = 0; 
					oldChain = 0;
				}
			}
			if (curFloor == 8)
			{
				display << " You killed Everyone in the Warehouse and saved " << gfName << ". Good Job!" << endl;
				display << " Not only that but you came out $" << icurScore << " richer! " << endl;
				display << "              Total Exp: " << p1->getExperience() << endl;
				display << "     Total Punks Killed: " << totalKills << endl;
				display << "          Highest Chain: " << maxChain << endl; 
				display << "                          ~:,,,,,,,...,,,:::,,,,:,,.,,,..,                  " << endl;
				display << "                          :,:,+:~?:,,,,,,::~~~~~:::,......                  " << endl;
				display << "                         ,,,::+??:~:,,,,,,~~=+++=++=:,....,                 " << endl;
				display << "              ?==~~~=:~~=~::,+=~::~~:~==+++++++++====~,....,                " << endl;
				display << "          ?I==+=:,,:,,,,::==~~=+~?~~~=+?+++??++++++==~:,...~                " << endl;
				display << "         ??=~==:,~,::::~=:~=:+~~+=+:=++??++++????++==~~:,..                 " << endl;
				display << "         +~::=~:~:=~=+=~=+==~:~=~===+++???++==,,:+++==~:,=                  " << endl;
				display << "       ?+::,~~=+==++????+===~~=~=~~=++????++:~==:.:+==~:~                   " << endl;
				display << "       ~:::~::=~=+??IIII??~=~~::~~~+=++????+~~::,:,~==~                     " << endl;
				display << "      ,:,:,,,:~~=?IIIIII???+~~~=,~::=+++???++=~+++?=:,                      " << endl;
				display << "      ,,,,:,::~:???IIIIII????=+====~:~~+++++++????+,,                       " << endl;
				display << "      ::,,,,:::+???I??:~??????=~=+:~~~::~~=++?+???=.                        " << endl;
				display << "      :..,,,,,++????+++=+++=????~:=~==~~::+??:~??+~~                        " << endl;
				display << "  ,.,...,...,:++~=+?I?==~::=II??+:~+~~~~=:~=++~~=~                          " << endl;
				display << ",,,,........,:~==~:+I??+~=??II??+=::,.,,:~,~~=:,=                           " << endl;
				display << ",,,,,,.,....,~:~++,+?I??I??III???+=~~.,,~==~,~~                             " << endl;
				display << ",,,,.,,,,,...:,:,:==I?I??+++??+??++~..,:,~~=~?~                             " << endl;
				display << "......,,,,,,,.==??+=?II?~I??~~++++++,..:.,::=~~                             " << endl;
				display << ".....,.,,,,,,..=+?+:,:~+?III+:~+++?+,,,..:.,=~=~?                           " << endl;
				display << ".........,,,,,,.:+=~::??+=+I7+???+++~,......++~=                            " << endl;
				display << ",,....,,,,,,,,,..,~::::?I77:?????++++.......,=,:=                           " << endl;
				display << "....,,..,,,,,,,,,.,:.,+=::+I?II??++~........,.=:~                           " << endl;
				display << "........,,,,,,,,,,,:::,~=+=?II?I?:..........,.,.:+++++                      " << endl;
				display << ".,........,,,,,,,,,.~:::=++?I?=................,,,,~++++                    " << endl;
				display << ".....,,,,..,,,,,,,,,...:~++??......................,++?++==+?++             " << endl;
				display << "..,...,,,,,,,,,,,,,,,....:~~........................~==++====++++           " << endl;
				display << "...,,,,,,.,,,,,,,,,,,,........................~++=++=++==+===~+++           " << endl;
				display << "....,,,,.,+?+???+???:,...................,=+++++++++++======~~++            " << endl;
				display << "..,.,.,=++???????+++++,...,:~=++++++++?+??????+++++=======~~~~++            " << endl;
				display << "..,..,=++++++?????++?++++++++++????????????++++++++======~~~~:++            " << endl;
				display << "....:~==++++++????+++++++?+???????????????++++++++====~~~::::,              " << endl;
				display << "....:~~====++++++++++++?+++?????????+++?++++++=====~~~::::,,,,              " << endl;
				display << "....,:~~====++++++++++++?????????+?+++++++++====~~~~~:~~,,,,,:              " << endl;
				display << "......:~~~====+++++++++????????+?+++++++++====~~~::~~:,...,,:~              " << endl;
				updateDisplay(display, displayVector);
				//Comment for ncurses:
				//displaydisplayVector(displayVector);
				//cin.get();
				//Un-Comment for ncurses:
				updateNcurses(displayVector);
				getch();
				pInput = 'q';
			}
			else if (p1->getHealth() <= 0)
			{
				display << endl;
				display << " You died and failed to save " << gfName << ". I guess your not tough enough!" << endl;
				display << " It's a shame, you would have came out over $" << icurScore << " richer! " << endl;
				display << "              Total Exp: " << p1->getExperience() << endl;
				display << "     Total Punks Killed: " << totalKills << endl;
				display << "          Highest Chain: " << maxChain << endl; 
				display << endl;
				display << " Don't be a wimp! Try again!!! " << endl;
				updateDisplay(display, displayVector);
				//Comment for ncurses:
				//displaydisplayVector(displayVector);
				//cin.get();
				//Un-Comment for ncurses:
				updateNcurses(displayVector);
				getch();
				pInput = 'q';
			}
			else if (baseFloor < curFloor) {dLevels[curFloor].setStart(p1); dLevels[curFloor].spawnEntities(); baseFloor = curFloor;}
			else if (baseFloor > curFloor) {dLevels[curFloor].setEnd(p1); dLevels[curFloor].spawnEntities(); baseFloor = curFloor;}
		}
	}
	//Comment for ncurses
	//cin.get();
	//Un-Comment for ncurses:
	getch();
	endwin();
	return 0;
}
